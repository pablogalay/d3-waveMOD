{"version":3,"file":"d3-wave.js","sources":["../src/rowRenderers/base.ts","../src/rowRenderers/numFormat.ts","../src/rowRenderers/bits.ts","../src/rowRenderers/enum.ts","../src/rowRenderers/label.ts","../src/rowRenderers/struct.ts","../src/signalLabelManipulation.ts","../src/timeFormat.ts","../src/binarySearch.ts","../src/filterData.ts","../src/rowRenderers/bit.ts","../src/rowRenderers/array.ts","../src/scrollbar.ts","../src/treeList.ts","../src/dragBar.ts","../src/exportSvg.ts","../node_modules/style-inject/dist/style-inject.es.js","../src/contextMenu.ts","../src/signalLabelContextMenu.ts","../src/tooltip.ts","../src/sizes.ts","../src/waveGraph.ts","../src/hexEdit.ts"],"sourcesContent":["import type { WaveGraph } from '../waveGraph';\r\nimport { AnyWaveGraphValue, SignalDataValueTuple, WaveGraphSignalTypeInfo } from '../data';\r\n\r\nexport class RowRendererBase {\r\n\twaveGraph: WaveGraph;\r\n\tFORMATTERS: { [formatName: string]: (d: any) => string };\r\n\tDEFAULT_FORMAT?: string | ((d: AnyWaveGraphValue) => string);\r\n\r\n\tconstructor(waveGraph: WaveGraph) {\r\n\t\tthis.waveGraph = waveGraph;\r\n\t\tthis.FORMATTERS = {};\r\n\t\tthis.DEFAULT_FORMAT = undefined;\r\n\t}\r\n\t/*eslint no-unused-vars: [\"error\", { \"args\": \"none\" }]*/\r\n\tselect(typeInfo: WaveGraphSignalTypeInfo): boolean {\r\n\t\tthrow new Error('Should be overriden in class implementation');\r\n\t}\r\n\r\n\trender(parent: d3.Selection<SVGGElement, any, any, any>, data: SignalDataValueTuple[], typeInfo: WaveGraphSignalTypeInfo, formatter?: string | ((d: AnyWaveGraphValue) => string)) {\r\n\t\tvar waveRowHeight = this.waveGraph.sizes.row.height;\r\n\t\t// var waveRowYpadding = this.waveGraph.sizes.row.ypadding;\r\n\t\tvar waveRowX = this.waveGraph.waveRowX;\r\n\t\t\r\n\t\tif (!waveRowX)\r\n\t\t\tthrow new Error(\"waveRowX on waveGraph must be initialized\");\r\n\t\t\r\n\t\tparent\r\n\t\t\t.selectAll<SVGGElement, WaveGraphSignalTypeInfo>('.value-background')\r\n\t\t\t.remove()\r\n\t\t\t.exit()\r\n\t\t\t.data([typeInfo])\r\n\t\t\t.enter()\r\n\t\t\t.append<SVGRectElement>(\"rect\")\r\n\t\t\t.attr('class', 'value-background')\r\n\t\t\t.attr('x', -2)\r\n\t\t\t.attr('width', this.waveGraph.sizes.width)\r\n\t\t\t.attr('height', waveRowHeight + 4)\r\n\t\t\t.classed('selected', (d) => !!d.isSelected)\r\n\t}\r\n}\r\n","import type { NumbericDataValue, NumbericDataVectorValue } from '../data';\r\n\r\nconst NUM_FORMATS: { [k: string]: number } = {\r\n\t'b': 2,\r\n\t'o': 8,\r\n\t'd': 10,\r\n\t'x': 16\r\n};\r\n\r\nfunction genFormatter(newBase: number): (d: NumbericDataValue) => string {\r\n\r\n\treturn function (d: NumbericDataValue) {\r\n\t\tif (typeof d === 'number')\r\n\t\t\treturn d.toString(newBase);\r\n\t\tif (d === \"X\")\r\n\t\t\treturn d;\r\n\t\tlet baseChar: string = d[0];\r\n\t\td = d.substring(1);\r\n\t\tlet base: number = NUM_FORMATS[baseChar];\r\n\t\tif (base === newBase) { return d; }\r\n\t\td = d.toUpperCase();\r\n\t\tlet containsX = d.indexOf('X') >= 0;\r\n\t\tif (containsX && newBase === 10) { return 'X'; }\r\n\r\n\t\tlet origD = d;\r\n\t\tif (containsX) {\r\n\t\t\td = d.replace(/X/g, '0');\r\n\t\t}\r\n\r\n\t\tlet num = BigInt('0' + baseChar + d).toString(newBase);\r\n\r\n\t\tif (newBase === 2) { newBase = 1; }\r\n\t\tif (base === 2) { base = 1; }\r\n\r\n\t\tif (containsX) {\r\n\t\t\tlet _num = [];\r\n\t\t\tfor (let i = 0; i < num.length; i++) {\r\n\t\t\t\t_num.push(num[i]);\r\n\t\t\t}\r\n\t\t\t// set digits which are not valid to X\r\n\t\t\tif (base < newBase) {\r\n\t\t\t\t// e.g. bin -> hex\r\n\t\t\t\tlet digitRatio = newBase / base;\r\n\t\t\t\tfor (let i = 0; i < num.length; i++) {\r\n\t\t\t\t\tlet offset = i * digitRatio;\r\n\t\t\t\t\tfor (var i2 = 0; i2 < digitRatio; i2++) {\r\n\t\t\t\t\t\tif (origD[offset + i2] === 'X') {\r\n\t\t\t\t\t\t\t// invalidate corresponding digit if there was a X in original value\r\n\t\t\t\t\t\t\t_num[i] = 'X';\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t// e.g. hex -> bin\r\n\t\t\t\tlet digitRatio = base / newBase;\r\n\t\t\t\tfor (let i = 0; i < origD.length; i++) {\r\n\t\t\t\t\tif (origD[i] === 'X') {\r\n\t\t\t\t\t\tlet end = i * digitRatio;\r\n\t\t\t\t\t\t// invalidate all corresponding digits if there was a X in original value\r\n\t\t\t\t\t\tfor (let i2 = i * digitRatio; i2 < end; i2++) {\r\n\t\t\t\t\t\t\t_num[i2] = 'X';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tnum = _num.join('');\r\n\t\t}\r\n\r\n\t\treturn num;\r\n\t};\r\n}\r\n\r\nfunction genVectorFormatter(newBase: number): (d: any) => string {\r\n\tvar itemFormat = genFormatter(newBase);\r\n\r\n\treturn function (d: NumbericDataVectorValue) {\r\n\t\tif (typeof d === 'string')\r\n\t\t\treturn itemFormat(d);\r\n\t\t// @param d: [[index list], value]\r\n\t\tvar buff = [];\r\n\t\tvar indexes = d[0];\r\n\t\tindexes.forEach(function (i: number) {\r\n\t\t\tbuff.push(\"[\");\r\n\t\t\tbuff.push(i);\r\n\t\t\tbuff.push(\"]\");\r\n\t\t})\r\n\t\tbuff.push(\"=\");\r\n\t\tbuff.push(itemFormat(d[1]));\r\n\t\treturn buff.join(\"\");\r\n\t}\r\n}\r\n\r\nexport const SCALAR_FORMAT: { [formatName: string]: (d: NumbericDataValue) => string } = {\r\n\t\"UINT_BIN\": genFormatter(2),\r\n\t\"UINT_OCT\": genFormatter(8),\r\n\t\"UINT_DEC\": genFormatter(10),\r\n\t\"UINT_HEX\": genFormatter(16),\r\n};\r\n\r\nexport const VECTOR_FORMAT: { [formatName: string]: (d: NumbericDataVectorValue) => string } = {\r\n\t\"UINT_BIN\": genVectorFormatter(2),\r\n\t\"UINT_OCT\": genVectorFormatter(8),\r\n\t\"UINT_DEC\": genVectorFormatter(10),\r\n\t\"UINT_HEX\": genVectorFormatter(16)\r\n};\r\n","import { RowRendererBase } from './base';\r\nimport { SCALAR_FORMAT } from './numFormat';\r\nimport type { WaveGraph } from '../waveGraph';\r\nimport type { AnyWaveGraphValue, SignalDataValueTuple, WaveGraphSignalTypeInfo } from '../data';\r\n\r\n/**\r\n * A renderer for bit vector value rows.\r\n * Value is supposed to be a number or based string without leading 0 (eg. \"x10\" instead of \"0x10\" )\r\n */\r\nexport class RowRendererBits extends RowRendererBase {\r\n\tconstructor(waveGraph: WaveGraph) {\r\n\t\tsuper(waveGraph);\r\n\t\tthis.FORMATTERS = SCALAR_FORMAT;\r\n\t\tthis.DEFAULT_FORMAT = SCALAR_FORMAT.UINT_HEX as ((d: AnyWaveGraphValue) => string);\r\n\t}\r\n\r\n\tselect(typeInfo: WaveGraphSignalTypeInfo) {\r\n\t\treturn typeInfo.name === 'wire' && typeInfo.width as number > 1;\r\n\t}\r\n\tisValid(d: any) {\r\n\t\treturn d[1].indexOf('X') < 0;\r\n\t}\r\n\t/*eslint no-unused-vars: [\"error\", { \"args\": \"none\" }]*/\r\n\trender(parent: d3.Selection<SVGGElement, any, any, any>, data: SignalDataValueTuple[], typeInfo: WaveGraphSignalTypeInfo, formatter?: string | ((d: AnyWaveGraphValue) => string)) {\r\n\t\tsuper.render(parent, data, typeInfo, formatter);\r\n\t\tvar waveRowHeight = this.waveGraph.sizes.row.height;\r\n\t\tvar waveRowYpadding = this.waveGraph.sizes.row.ypadding;\r\n\t\tvar waveRowX = this.waveGraph.waveRowX;\r\n\t\tif (!waveRowX)\r\n\t\t\tthrow new Error(\"waveRowX on waveGraph must be initialized\");\r\n\t\tif (!formatter || typeof formatter === 'string')\r\n\t\t\tthrow new Error(\"Unsupported formater\");\r\n\r\n\t\tvar rect = parent.selectAll('g .value-rect')\r\n\t\t\t.remove()\r\n\t\t\t.exit()\r\n\t\t\t.data(data);\r\n\r\n\t\tvar newRects = rect.enter()\r\n\t\t\t.append('g');\r\n\t\tvar renderer = this;\r\n\t\tnewRects\r\n\t\t\t.attr('transform', function (d: SignalDataValueTuple) {\r\n\t\t\t\tif (!waveRowX)\r\n\t\t\t\t\tthrow new Error(\"waveRowX on waveGraph must be initialized\");\r\n\t\t\t\tvar t = waveRowX(d[0]);\r\n\t\t\t\treturn 'translate(' + [t, 0] + ')';\r\n\t\t\t})\r\n\t\t\t.attr('class', function (d: SignalDataValueTuple) {\r\n\t\t\t\tif (renderer.isValid(d)) {\r\n\t\t\t\t\treturn 'value-rect value-rect-valid';\r\n\t\t\t\t}\r\n\t\t\t\treturn 'value-rect value-rect-invalid';\r\n\t\t\t})\r\n\t\tvar x0 = waveRowX.domain()[0];\r\n\t\t// can not use index from d function because it is always 0\r\n\t\tnewRects.append('path')\r\n\t\t\t.attr('d', function (d: SignalDataValueTuple) {\r\n\t\t\t\tvar duration = d[2];\r\n\t\t\t\tif (!waveRowX)\r\n\t\t\t\t\tthrow new Error(\"waveRowX on waveGraph must be initialized\");\r\n\t\t\t\tvar right = waveRowX(x0 + duration);\r\n\t\t\t\tvar top = waveRowHeight;\r\n\t\t\t\tif (right < 0) {\r\n\t\t\t\t\tthrow new Error(`${right}, ${d}`);\r\n\t\t\t\t}\r\n\t\t\t\t//  <==> like shape\r\n\t\t\t\tvar edgeW = 2;\r\n\t\t\t\treturn 'M ' + [0, top / 2] +\r\n\t\t\t\t\t' L ' + [edgeW, top] +\r\n\t\t\t\t\t' L ' + [right - edgeW, top] +\r\n\t\t\t\t\t' L ' + [right, top / 2] +\r\n\t\t\t\t\t' L ' + [right - edgeW, 0] +\r\n\t\t\t\t\t' L ' + [edgeW, 0] + ' Z';\r\n\t\t\t});\r\n\r\n\r\n\t\t// can not use index from d function because it is always 0\r\n\t\tnewRects.append('text')\r\n\t\t\t.attr('x', function (d: SignalDataValueTuple) {\r\n\t\t\t\tvar duration = d[2];\r\n\t\t\t\tif (!waveRowX)\r\n\t\t\t\t\tthrow new Error(\"waveRowX on waveGraph must be initialized\");\r\n\t\t\t\tvar x = waveRowX(x0 + duration / 2);\r\n\t\t\t\tif (x < 0) { throw new Error(x.toString()); }\r\n\t\t\t\treturn x;\r\n\t\t\t})\r\n\t\t\t.attr('y', waveRowHeight / 2 + waveRowYpadding)\r\n\t\t\t.text(function (d: SignalDataValueTuple) {\r\n\t\t\t\tlet fontSizeStr = window.getComputedStyle(this).fontSize;\r\n\t\t\t\tlet fontSize = NaN;\r\n\t\t\t\tif (fontSizeStr === \"\") {\r\n\t\t\t\t\t// default font size\r\n\t\t\t\t\tfontSize = 16;\r\n\t\t\t\t} else if (fontSizeStr.substr(fontSizeStr.length - 2) !== \"px\") {\r\n\t\t\t\t\tthrow new Error(fontSizeStr);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfontSize = Number(fontSizeStr.substr(0, fontSizeStr.length - 2));\r\n\t\t\t\t}\r\n\t\t\t\tvar formatedText = formatter(d[1]);\r\n\t\t\t\tvar duration = d[2];\r\n\t\t\t\tif (!waveRowX)\r\n\t\t\t\t\tthrow new Error(\"waveRowX on waveGraph must be initialized\");\r\n\t\t\t\tvar width = waveRowX(x0 + duration) - waveRowX(x0);\r\n\t\t\t\tif (width < 0) {\r\n\t\t\t\t\tthrow new Error(`${x0}, ${duration}, ${width}`);\r\n\t\t\t\t}\r\n\t\t\t\tif (formatedText.length * fontSize > width) {\r\n\t\t\t\t\tvar chars = Math.ceil(width / fontSize);\r\n\t\t\t\t\treturn formatedText.substr(0, chars);\r\n\t\t\t\t}\r\n\t\t\t\treturn formatedText;\r\n\t\t\t});\r\n\r\n\t}\r\n}\r\n","import { RowRendererBits } from './bits';\r\nimport type { WaveGraph } from '../waveGraph';\r\nimport { AnyWaveGraphValue, WaveGraphSignalTypeInfo } from '../data';\r\n\r\nexport const STRING_FORMAT: { [formatName: string]: (d: AnyWaveGraphValue) => string } = {\r\n\t\"STRING\": (d: AnyWaveGraphValue) => d.toString(),\r\n}\r\n\r\n/**\r\n * A renderer for enum value rows, enum value is a string, \"\" is resolved as invalid value\r\n * and is rendered with red color\r\n */\r\nexport class RowRendererEnum extends RowRendererBits {\r\n\tconstructor(waveGraph: WaveGraph) {\r\n\t\tsuper(waveGraph);\r\n\t\tthis.FORMATTERS = STRING_FORMAT;\r\n\t\tthis.DEFAULT_FORMAT = STRING_FORMAT.STRING;\r\n\t}\r\n\tselect(typeInfo: WaveGraphSignalTypeInfo) {\r\n\t\treturn typeInfo.name === 'enum';\r\n\t}\r\n\tisValid(d: any) {\r\n\t\treturn d[1] !== '';\r\n\t}\r\n}\r\n","import { WaveGraphSignalTypeInfo } from '../data';\r\nimport { RowRendererBase } from './base';\r\n/**\r\n * A renderer for a label which poses no data and it is only a form of separator between value rows\r\n */\r\nexport class RowRendererLabel extends RowRendererBase {\r\n\tselect(typeInfo: WaveGraphSignalTypeInfo) {\r\n\t\treturn typeInfo.name === 'label';\r\n\t}\r\n}\r\n","import { WaveGraphSignalTypeInfo } from '../data';\r\nimport { RowRendererBase } from './base';\r\n\r\n/**\r\n * Reneers nothig, it is used for hierarchical signals as a parent container.\r\n */\r\nexport class RowRendererStruct extends RowRendererBase {\r\n\tselect(typeInfo: WaveGraphSignalTypeInfo) {\r\n\t\treturn typeInfo.name === 'struct';\r\n\t}\r\n}\r\n","import type { TreeList, HierarchyNodeWaveGraphSignalWithXYId } from './treeList';\r\nimport type { WaveGraphSignal } from './data';\r\nimport * as d3 from 'd3';\r\n\r\ninterface Point {\r\n\tx: number;\r\n\ty: number;\r\n};\r\n\r\nexport class SignalLabelManipulation {\r\n\tROW_Y: number; // height of the row where signal label is rendered\r\n\tsignalList: TreeList; // tree list which is beeing manipulated\r\n\tpreviouslyClicked: HierarchyNodeWaveGraphSignalWithXYId | null; // a previously clicked item for selection\r\n\tlabels: d3.Selection<SVGGElement, HierarchyNodeWaveGraphSignalWithXYId, HTMLDivElement, any> | null;\r\n\tdropLocator: d3.Selection<SVGGElement, undefined, HTMLDivElement, any> | null;\r\n\r\n\tconstructor(ROW_Y: number, signalList: TreeList) {\r\n\t\tthis.previouslyClicked = null;\r\n\t\tthis.signalList = signalList;\r\n\t\tthis.labels = null;\r\n\t\tthis.ROW_Y = ROW_Y;\r\n\t\tthis.dropLocator = null;\r\n\t}\r\n\r\n\tresolveInsertTarget(y: number): [HierarchyNodeWaveGraphSignalWithXYId | undefined, number | undefined] {\r\n\t\tlet targetParentNode = null;\r\n\t\tlet onParentI = 0;\r\n\r\n\t\tconst nodes = this.signalList.visibleNodes();\r\n\t\tif (y < 0) {\r\n\t\t\tthrow new Error();\r\n\t\t}\r\n\t\tfor (var i = 0; i < nodes.length; i++) {\r\n\t\t\tvar n = nodes[i];\r\n\t\t\tconst isUpperHalfOfTheRow = y > (n.y as number) && y <= (n.y as number) + this.ROW_Y * 0.5;\r\n\t\t\tif (isUpperHalfOfTheRow && n.parent) {\r\n\t\t\t\t// position in upper half of the row\r\n\t\t\t\t// insert before n (parent is checked to exists)\r\n\t\t\t\tconst siblings = n.parent.children;\r\n\t\t\t\ttargetParentNode = n.parent;\r\n\t\t\t\tif (!siblings)\r\n\t\t\t\t\tthrow new Error(\"siblings must be specified because we are searching in siblings\");\r\n\t\t\t\tonParentI = siblings.indexOf(n);\r\n\t\t\t\tbreak;\r\n\t\t\t} else if (y <= (n.y as number) + this.ROW_Y) {\r\n\t\t\t\t// insert after\r\n\t\t\t\t// if n is hierarchical insert into\r\n\t\t\t\tif (n.children) {\r\n\t\t\t\t\ttargetParentNode = n;\r\n\t\t\t\t\tonParentI = 0;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttargetParentNode = n.parent;\r\n\t\t\t\t\tif (!targetParentNode)\r\n\t\t\t\t\t\tthrow new Error(\"Parent must be specified because we are searching in siblings\");\r\n\t\t\t\t\tconst siblings = targetParentNode.children;\r\n\t\t\t\t\tif (!siblings)\r\n\t\t\t\t\t\tthrow new Error(\"siblings must be specified because we are searching in siblings\");\r\n\t\t\t\t\tonParentI = siblings.indexOf(n) + 1;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (!targetParentNode) {\r\n\t\t\ttargetParentNode = nodes[0];\r\n\t\t\tonParentI = targetParentNode.children?.length || 0;\r\n\t\t}\r\n\r\n\t\treturn [targetParentNode, onParentI];\r\n\t}\r\n\r\n\t// select and de-select all \"g\"\r\n\t// signal labels dragging, reordering\r\n\tdragStarted(ev: d3.D3DragEvent<SVGGElement, HierarchyNodeWaveGraphSignalWithXYId, any>,\r\n\t\telm: d3.Selection<SVGGElement, HierarchyNodeWaveGraphSignalWithXYId, any, any>,\r\n\t\td: HierarchyNodeWaveGraphSignalWithXYId) {\r\n\t\t// move to front to make it virtually on top of all others\r\n\t\telm.raise();\r\n\t\t// d = index of clicked signal\r\n\t\tvar current = d;\r\n\t\tvar currentlySelected = current.data.type.isSelected;\r\n\t\tvar shiftKey = ev.sourceEvent.shiftKey;\r\n\t\tif (shiftKey && this.previouslyClicked) {\r\n\t\t\t// select all between last selected and clicked\r\n\t\t\t// de-select all\r\n\t\t\tif (this.signalList) {\r\n\t\t\t\tvar prevId = this.previouslyClicked.id as any as number;\r\n\t\t\t\tthis.signalList.visibleNodes().forEach(function (d) {\r\n\t\t\t\t\tconst i = d.id as any as number;\r\n\t\t\t\t\tconst curId = current.id as any as number;\r\n\t\t\t\t\tif (prevId < curId) {\r\n\t\t\t\t\t\td.data.type.isSelected = prevId <= i && i <= curId;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\td.data.type.isSelected = prevId >= i && i >= curId;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tif (this.labels)\r\n\t\t\t\tthis.labels.classed('selected', (d: HierarchyNodeWaveGraphSignalWithXYId) => !!d.data.type.isSelected);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar altKey = ev.sourceEvent.altKey;\r\n\t\tif (!altKey) {\r\n\t\t\tif (this.signalList) {\r\n\t\t\t\tthis.signalList.visibleNodes().forEach(function (d) {\r\n\t\t\t\t\td.data.type.isSelected = false;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t\t// toggle selection\r\n\t\tcurrent.data.type.isSelected = !currentlySelected;\r\n\t\tif (this.labels) {\r\n\t\t\tthis.labels.classed('selected', (d: HierarchyNodeWaveGraphSignalWithXYId) => !!d.data.type.isSelected);\r\n\t\t}\r\n\t}\r\n\t/* take ale  */\r\n\t_getXYforItemOnIndex(parentItem: HierarchyNodeWaveGraphSignalWithXYId, i: number) {\r\n\t\tconst children = parentItem.children;\r\n\t\tif (!children || children.length == 0 || i == 0)\r\n\t\t\treturn [parentItem.x, parentItem.y];\r\n\t\telse if (i < children.length) {\r\n\t\t\tconst c = children[i];\r\n\t\t\treturn [c.x, c.y];\r\n\t\t} else {\r\n\t\t\tif (i != children.length)\r\n\t\t\t\tthrow new Error(\"Must be append or in children\");\r\n\t\t\tlet lastItem = children[children.length-1];\r\n\t\t\twhile (lastItem.children?.length) {\r\n\t\t\t\tlastItem = lastItem.children[lastItem.children.length-1];\r\n\t\t\t}\r\n\t\t\treturn [parentItem.x, (lastItem.y || 0) + this.ROW_Y];\r\n\t\t}\r\n\r\n\t} \r\n\tdragged(ev: d3.D3DragEvent<SVGGElement, HierarchyNodeWaveGraphSignalWithXYId, any>,\r\n\t\telm: d3.Selection<SVGGElement, HierarchyNodeWaveGraphSignalWithXYId, any, any>,\r\n\t\td: HierarchyNodeWaveGraphSignalWithXYId) {\r\n\t\tconst labelG = this.signalList.labelG;\r\n\t\tif (!labelG)\r\n\t\t\tthrow new Error(\"labelG must be constructed before labels\");\r\n\t\t\r\n\t\tlet dropLocator = this.dropLocator;\r\n\t\tif (!dropLocator) {\r\n\t\t\tthis.dropLocator = dropLocator = labelG.append<SVGGElement>(\"g\");\r\n\t\t\tdropLocator.attr('class', 'drop-locator')\r\n\t\t\tconst rect = dropLocator.append('rect')\r\n\t\t\trect.attr('height', 4)\r\n\t\t\t\t.attr('width', this.signalList.width || 10)\r\n\t\t\t\t.style('fill', 'blue');\r\n\t\t}\r\n\t\tconst [insParent, insIndex] = this.resolveInsertTarget(ev.y);\r\n\t\tlet [insPointX, insPointY] = this._getXYforItemOnIndex(insParent ? insParent: this.signalList.root as HierarchyNodeWaveGraphSignalWithXYId, insIndex || 0)\r\n\t\tdropLocator.attr('transform', `translate(${insPointX}, ${insPointY})`);\r\n\t\telm.attr('transform', `translate(${d.x}, ${ev.y})`);\r\n\t}\r\n\tregenerateDepth(d: HierarchyNodeWaveGraphSignalWithXYId) {\r\n\t\tvar offset = d.depth;\r\n\t\t(d.children || []).forEach((d2: HierarchyNodeWaveGraphSignalWithXYId) => {\r\n\t\t\t(d2 as any).depth = offset + 1;\r\n\t\t\tthis.regenerateDepth(d2);\r\n\t\t});\r\n\t}\r\n\tdragEnded(ev: d3.D3DragEvent<SVGGElement, HierarchyNodeWaveGraphSignalWithXYId, any>,\r\n\t\telm: d3.Selection<SVGGElement, HierarchyNodeWaveGraphSignalWithXYId, any, any>,\r\n\t\td: HierarchyNodeWaveGraphSignalWithXYId) {\r\n\t\t// move to front to make it virtually on top of all others\r\n\t\telm.lower();\r\n\t\tlet dropLocator = this.dropLocator;\r\n\t\tif (dropLocator) {\r\n\t\t\tdropLocator.remove();\r\n\t\t\tthis.dropLocator = null;\r\n\t\t}\r\n\t\tconst insertTarget = this.resolveInsertTarget(ev.y);\r\n\t\tconst shiftKey = ev.sourceEvent.shiftKey;\r\n\t\tif (!(this.previouslyClicked != null && shiftKey) && d.data.type.isSelected) {\r\n\t\t\tthis.previouslyClicked = d;\r\n\t\t} else {\r\n\t\t\tthis.previouslyClicked = null;\r\n\t\t}\r\n\r\n\t\t// check if inserting to it self\r\n\t\tvar newParent = insertTarget[0] as (HierarchyNodeWaveGraphSignalWithXYId | null);\r\n\t\tvar newIndex = insertTarget[1] as number;\r\n\t\tvar _newParent = newParent;\r\n\t\tvar insertingToItself = false;\r\n\t\twhile (_newParent) {\r\n\t\t\tif (_newParent === d) {\r\n\t\t\t\tinsertingToItself = true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\t_newParent = _newParent.parent;\r\n\t\t}\r\n\r\n\t\tif (!insertingToItself && (\r\n\t\t\tnewParent !== d.parent ||\r\n\t\t\t(d.parent && d.parent.children && newIndex !== d.parent.children.indexOf(d)))) {\r\n\r\n\t\t\t// moving on new place\r\n\t\t\telm.classed('selected', false);\r\n\t\t\td.data.type.isSelected = false;\r\n\t\t\t// insert on new place (we do it first, because we do not want to break indexing)\r\n\t\t\tvar oldSiblings = d.parent?.children || [];\r\n\t\t\tvar oldIndex = oldSiblings.indexOf(d);\r\n\t\t\tvar newSiblings = (insertTarget[0] as HierarchyNodeWaveGraphSignalWithXYId).children || [];\r\n\t\t\tnewSiblings.splice(newIndex, 0, d);\r\n\t\t\t// remove from original possition\r\n\t\t\tif (newSiblings === oldSiblings && newIndex < oldIndex) {\r\n\t\t\t\toldIndex += 1;\r\n\t\t\t}\r\n\t\t\toldSiblings.splice(oldIndex, 1);\r\n\t\t\td.parent = insertTarget[0] as HierarchyNodeWaveGraphSignalWithXYId;\r\n\t\t\t(d as any).depth = d.parent.depth + 1;\r\n\t\t\tthis.regenerateDepth(d);\r\n\t\t\tif (this.signalList) {\r\n\t\t\t\tthis.signalList.update();\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t// put label back to it's original possition\r\n\t\t\telm.attr('transform', `translate(${d.x}, ${d.y})`);\r\n\t\t}\r\n\t}\r\n\tregisterDrag(labels: d3.Selection<SVGGElement, HierarchyNodeWaveGraphSignalWithXYId, any, any>) {\r\n\t\tvar _this = this;\r\n\t\tthis.labels = labels;\r\n\t\tlabels.call(\r\n\t\t\td3.drag<SVGGElement, HierarchyNodeWaveGraphSignalWithXYId>()\r\n\t\t\t\t.on('start', function (this: SVGGElement, ev, d) {\r\n\t\t\t\t\treturn _this.dragStarted(ev, d3.select<SVGGElement, HierarchyNodeWaveGraphSignalWithXYId>(this as any as SVGGElement), d);\r\n\t\t\t\t})\r\n\t\t\t\t.on('drag', function (this: SVGGElement, ev, d) {\r\n\t\t\t\t\treturn _this.dragged(ev, d3.select<SVGGElement, HierarchyNodeWaveGraphSignalWithXYId>(this as any as SVGGElement), d);\r\n\t\t\t\t})\r\n\t\t\t\t.on('end', function (this: SVGGElement, ev, d) {\r\n\t\t\t\t\treturn _this.dragEnded(ev, d3.select<SVGGElement, HierarchyNodeWaveGraphSignalWithXYId>(this as any as SVGGElement), d);\r\n\t\t\t\t})\r\n\t\t);\r\n\t}\r\n}\r\n","import * as d3 from 'd3';\r\n\r\nexport const TIME_UNITS: [number, string][] = [\r\n\t[1, 'ps'],\r\n\t[1000, 'ns'],\r\n\t[1000000, 'us'],\r\n\t[1000000000, 'ms'],\r\n\t[1000000000000, 's']\r\n];\r\n\r\nexport function createTimeFormatter(divider: number, unitName: string) {\r\n\treturn function(d: d3.NumberValue, i: number) {\r\n\t\tvar v = d as number / divider;\r\n\t\tif (Number.isInteger(v)) {\r\n\t\t\treturn v + ' ' + unitName;\r\n\t\t}\r\n\t\treturn v.toFixed(2) + ' ' + unitName;\r\n\r\n\t};\r\n}\r\n\r\nexport function createTimeFormatterForTimeRange(timeRange: [number, number]): (d: d3.NumberValue, i: number) => string {\r\n\tconst _timeRange = timeRange[1] - timeRange[0];\r\n\tfor (var i = 0; i < TIME_UNITS.length; i++) {\r\n\t\tvar u = TIME_UNITS[i];\r\n\t\tif (_timeRange < 1000 * u[0] || i === TIME_UNITS.length - 1) {\r\n\t\t\treturn createTimeFormatter(u[0], u[1]);\r\n\t\t}\r\n\t}\r\n\tthrow new Error(\"Time out of range of defined units\");\r\n}\r\n","/**\r\n * @param compareFn: example (a, b) => { return a - b; }\r\n * @param boundaryCheckFn: a function used to check array boundaris\r\n *        before main alg, example:\r\n *        function (ar, el) {\r\n *           if (el < ar[0]) { return 0; }\r\n *           if (el > ar[ar.length - 1]) { return ar.length; }\r\n *           return -1;\r\n *        }\r\n */\r\nexport function binarySearch<T>(ar: T[],\r\n\tel: T,\r\n\tcompareFn: (a: T, b: T) => number,\r\n\tboundaryCheckFn: (arr: T[], elm: T) => number): number {\r\n\r\n\tif (ar.length === 0)\r\n\t\treturn -1;\r\n\tvar res = boundaryCheckFn(ar, el);\r\n\tif (res >= 0)\r\n\t\treturn res;\r\n\r\n\tvar m = 0;\r\n\tvar n = ar.length - 1;\r\n\twhile (m <= n) {\r\n\t\tvar k = (n + m) >> 1; // floor(n+m/2)\r\n\t\tvar cmp = compareFn(el, ar[k]);\r\n\t\tif (cmp > 0) {\r\n\t\t\tm = k + 1;\r\n\t\t} else if (cmp < 0) {\r\n\t\t\tn = k - 1;\r\n\t\t} else {\r\n\t\t\treturn k;\r\n\t\t}\r\n\t}\r\n\treturn m - 1;\r\n}\r\n","import { binarySearch } from './binarySearch'\r\nimport { SignalDataValueTuple } from './data';\r\n\r\nexport function filterDataByTime(data: SignalDataValueTuple[], rowRange: [number, number]): SignalDataValueTuple[] {\r\n\t// return list ([time, value, duration])\r\n\tvar min = rowRange[0];\r\n\tif (min < 0) { throw new Error('min time has to be >= 0'); }\r\n\tvar max = rowRange[1];\r\n\tvar _data: SignalDataValueTuple[] = [];\r\n\r\n\tfunction boundaryCheckFn(ar: SignalDataValueTuple[], el: SignalDataValueTuple) {\r\n\t\tif (el[0] < ar[0][0]) { return 0; }\r\n\t\tif (el[0] > ar[ar.length - 1][0]) { return ar.length; }\r\n\t\treturn -1;\r\n\t}\r\n\tfor (var i = binarySearch(data, [min, \"\", 0], (a, b) => { return a[0] - b[0]; }, boundaryCheckFn); i < data.length; i++) {\r\n\t\tif (i < 0)\r\n\t\t\tbreak;\r\n\t\tvar d = data[i];\r\n\t\tvar t = d[0];\r\n\r\n\t\tif (t < min) {\r\n\t\t\t// data before actual dataset\r\n\t\t} else if (t <= max) {\r\n\t\t\tlet prev = data[i - 1];\r\n\t\t\tif (_data.length === 0 && t !== min) {\r\n\t\t\t\t// first data, unaligned\r\n\t\t\t\tlet prevVal: any;\r\n\t\t\t\tif (!prev) {\r\n\t\t\t\t\tprevVal = 'bX';\r\n\t\t\t\t} else {\r\n\t\t\t\t\tprevVal = prev[1];\r\n\t\t\t\t}\r\n\t\t\t\t_data.push([min, prevVal, t - min]);\r\n\t\t\t}\r\n\t\t\t// normal data in range\r\n\t\t\tvar next = data[i + 1];\r\n\t\t\tvar nextTime;\r\n\t\t\tif (next) {\r\n\t\t\t\tnextTime = Math.min(max, next[0]);\r\n\t\t\t} else {\r\n\t\t\t\tnextTime = max;\r\n\t\t\t}\r\n\r\n\t\t\t_data.push([t, d[1], nextTime - t]);\r\n\t\t} else {\r\n\t\t\tif (_data.length === 0) {\r\n\t\t\t\t// selection range smaller than one data item\r\n\t\t\t\tlet prev = data[i - 1];\r\n\t\t\t\tlet prevVal: any;\r\n\t\t\t\tif (!prev) {\r\n\t\t\t\t\tprevVal = 'bX';\r\n\t\t\t\t} else {\r\n\t\t\t\t\tprevVal = prev[1];\r\n\t\t\t\t}\r\n\t\t\t\t_data.push([min, prevVal, max - min]);\r\n\t\t\t}\r\n\t\t\t// after selected range\r\n\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\tif (_data.length === 0) {\r\n\t\t// no new data after selected range\r\n\t\tvar last = data[data.length - 1];\r\n\t\tvar lastVal: any;\r\n\t\tif (!last) {\r\n\t\t\tlastVal = 'bX';\r\n\t\t} else {\r\n\t\t\tlastVal = last[1];\r\n\t\t}\r\n\t\t_data.push([min, lastVal, max - min]);\r\n\t}\r\n\r\n\treturn _data;\r\n}\r\n","import * as d3 from 'd3';\r\nimport { RowRendererBase } from './base';\r\nimport { AnyWaveGraphValue, NumbericDataValue, SignalDataValueTuple, WaveGraphSignalTypeInfo } from '../data';\r\n\r\nexport class RowRendererBit extends RowRendererBase {\r\n\tselect(typeInfo: WaveGraphSignalTypeInfo) {\r\n\t\treturn typeInfo.name === 'wire' && typeInfo.width === 1;\r\n\t}\r\n\r\n\trender(parent: d3.Selection<SVGGElement, any, any, any>, data: SignalDataValueTuple[], typeInfo: WaveGraphSignalTypeInfo, formatter?: string | ((d: AnyWaveGraphValue) => string)) {\r\n\t\tsuper.render(parent, data, typeInfo, formatter);\r\n\t\tvar waveRowHeight = this.waveGraph.sizes.row.height;\r\n\t\t// var waveRowYpadding = this.waveGraph.sizes.row.ypadding;\r\n\t\tvar waveRowX = this.waveGraph.waveRowX;\r\n\t\tvar waveRowY = this.waveGraph.waveRowY;\r\n\t\tif (!waveRowX)\r\n\t\t\tthrow new Error(\"waveRowX on waveGraph must be initialized\");\r\n\t\tif (!waveRowY)\r\n\t\t\tthrow new Error(\"waveRowY on waveGraph must be initialized\");\r\n\r\n\t\tconst linePoints: [number, number][] = [];\r\n\t\tconst invalidRanges: SignalDataValueTuple[] = [];\r\n\t\tdata.forEach(function (d: [number, AnyWaveGraphValue, number]) {\r\n\t\t\tlet val = d[1];\r\n\t\t\tlet valInt = NaN;\r\n\t\t\tif (typeof val === 'string') {\r\n\t\t\t\tif (val.indexOf('X') >= 0) {\r\n\t\t\t\t\tinvalidRanges.push(d);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvalInt = Number.parseInt(val);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tvalInt = val as number;\r\n\t\t\t}\r\n\t\t\tlinePoints.push([d[0], valInt]);\r\n\t\t\tlinePoints.push([d[0] + d[2], valInt]);\r\n\r\n\t\t});\r\n\r\n\t\tvar line = d3.line()\r\n\t\t\t.x(function (d) {\r\n\t\t\t\tif (!waveRowX)\r\n\t\t\t\t\tthrow new Error(\"waveRowX on waveGraph must be initialized\");\r\n\r\n\t\t\t\treturn waveRowX(d[0]);\r\n\t\t\t})\r\n\t\t\t.y(function (d) {\r\n\t\t\t\tif (!waveRowY)\r\n\t\t\t\t\tthrow new Error(\"waveRowY on waveGraph must be initialized\");\r\n\r\n\t\t\t\treturn waveRowY(d[1]);\r\n\t\t\t})\r\n\t\t\t.curve(d3.curveStepAfter);\r\n\r\n\t\t// wave line\r\n\t\tparent.attr('clip-path', 'url(#clip)');\r\n\t\tvar lines = parent.selectAll<SVGPathElement, [number, number]>('path')\r\n\t\t\t.data([linePoints]);\r\n\t\tlines.enter()\r\n\t\t\t.append('path')\r\n\t\t\t.attr('class', 'value-line')\r\n\t\t\t.merge(lines)\r\n\t\t\t.attr('d', line);\r\n\r\n\t\t// Add the scatterplot for invalid values\r\n\t\tparent.selectAll('.value-rect-invalid')\r\n\t\t\t.remove()\r\n\t\t\t.exit()\r\n\t\t\t.data(invalidRanges)\r\n\t\t\t.enter()\r\n\t\t\t.append('g')\r\n\t\t\t.attr('class', 'value-rect-invalid')\r\n\t\t\t.append('rect')\r\n\t\t\t.attr('height', waveRowHeight)\r\n\t\t\t.attr('width', function (d) {\r\n\t\t\t\tif (!waveRowX)\r\n\t\t\t\t\tthrow new Error(\"waveRowX on waveGraph must be initialized\");\r\n\r\n\t\t\t\treturn waveRowX(waveRowX.domain()[0] + d[2]);\r\n\t\t\t})\r\n\t\t\t.attr('x', function (d) {\r\n\t\t\t\tif (!waveRowX)\r\n\t\t\t\t\tthrow new Error(\"waveRowX on waveGraph must be initialized\");\r\n\r\n\t\t\t\treturn waveRowX(d[0]);\r\n\t\t\t})\r\n\t\t\t.attr('y', function () {\r\n\t\t\t\tif (!waveRowY)\r\n\t\t\t\t\tthrow new Error(\"waveRowY on waveGraph must be initialized\");\r\n\r\n\t\t\t\treturn waveRowY(1);\r\n\t\t\t});\r\n\t}\r\n}\r\n","import type { WaveGraph } from '../waveGraph';\r\nimport { AnyWaveGraphValue, WaveGraphSignalTypeInfo } from '../data';\r\nimport { RowRendererBits } from './bits';\r\nimport { VECTOR_FORMAT } from './numFormat';\r\n\r\n/**\r\n * A renderer for value rows with data of array type.\r\n * The record of data is of following format: [[<indexes>], <new value>]\r\n */\r\nexport class RowRendererArray extends RowRendererBits {\r\n    constructor(waveGraph: WaveGraph) {\r\n        super(waveGraph);\r\n        this.FORMATTERS = VECTOR_FORMAT;\r\n        this.DEFAULT_FORMAT = VECTOR_FORMAT.UINT_HEX as ((d: AnyWaveGraphValue) => string);\r\n    }\r\n    select(typeInfo: WaveGraphSignalTypeInfo) {\r\n        return typeInfo.name === 'array';\r\n    }\r\n    isValid(d: any) {\r\n        if (typeof d === 'string')\r\n            return d.indexOf('X') < 0;\r\n        else\r\n            return d[1][1].indexOf('X') < 0;\r\n    }\r\n}","import * as d3 from 'd3';\r\nimport { HierarchyNodeWaveGraphSignalWithXYId } from './treeList';\r\n\r\n/**\r\n * Implementation of SVG based scrollbar component which has a histogram like columns which are showing the\r\n * depth of the items in signal list.  \r\n */\r\nexport class Scrollbar {\r\n    barHeight: number;\r\n    selectorWidth: number;\r\n    _onDrag: ((startPerc: number) => void) | null;\r\n    scrollbarG: d3.Selection<SVGGElement, any, any, any>;\r\n    moverElm: d3.Selection<SVGRectElement, null, SVGGElement, any>|null;\r\n    width: number;\r\n    height: number;\r\n    _isScrollDisplayed: boolean;\r\n    flatenedData: HierarchyNodeWaveGraphSignalWithXYId[];\r\n    maxDepth: number;\r\n    _startPerc: number;\r\n\r\n    constructor( barHeight: number, _scrollbarG: d3.Selection<SVGGElement, any, any, any>) {\r\n        this.barHeight = barHeight;\r\n        this.selectorWidth = 20;\r\n        this._onDrag = null;\r\n        this.scrollbarG = _scrollbarG;\r\n        this.moverElm = null;\r\n        this.width = 0;\r\n        this.height = 0;\r\n        this._isScrollDisplayed = false;\r\n        this.flatenedData = [];\r\n        this.maxDepth = -1;\r\n        this._startPerc = 0.0;\r\n\r\n    }\r\n    onDrag(fn: ((startPerc: number) => void) | null) {\r\n\t\tif (arguments.length) {\r\n\t\t\tthis._onDrag = fn;\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\treturn this._onDrag;\r\n\t};\r\n    render()  {\r\n        if (this._isScrollDisplayed) {\r\n            var numBars = Math.round(this.height / this.barHeight);\r\n            var xOverview = d3.scaleLinear()\r\n                .domain([0, this.maxDepth + 1])\r\n                .range([0, this.selectorWidth]);\r\n            var yOverview = d3.scaleLinear()\r\n                .domain([0, this.flatenedData.length])\r\n                .range([0, this.height]);\r\n            var subBars = this.scrollbarG.selectAll<SVGRectElement, HierarchyNodeWaveGraphSignalWithXYId>('.subBar')\r\n                .data(this.flatenedData);\r\n            const _this = this;\r\n            \r\n            subBars.exit().remove();\r\n            // small rectangles in scroll preview representing the values on that posssion\r\n            subBars.enter()\r\n                .append('rect')\r\n                .classed('subBar', true)\r\n                .merge(subBars)\r\n                .attr('height', function () {\r\n                    return yOverview(1);\r\n                })\r\n                .attr('width', function (d) {\r\n                    return xOverview(d.depth + 1);\r\n                })\r\n                .attr('x', function () {\r\n                    return _this.width - _this.selectorWidth;\r\n                })\r\n                .attr('y', function (d, i) {\r\n                    return yOverview(i);\r\n                });\r\n\r\n            // dragable rect representing currently viewed window\r\n            if (!this.moverElm) {\r\n                this.moverElm = this.scrollbarG.selectAll('.mover')\r\n                    .data([null])\r\n                    .enter()\r\n                    .append('rect');\r\n            }\r\n\r\n            this.moverElm\r\n                .classed('mover', true)\r\n                .attr('transform', 'translate(' + (this.width - this.selectorWidth) + ',0)')\r\n                .attr('class', 'mover')\r\n                .attr('x', 0)\r\n                .attr('y', this._startPerc * this.height)\r\n                .attr('height', Math.round((numBars / this.flatenedData.length) * this.height))\r\n                .attr('width', this.selectorWidth);\r\n            \r\n            this.moverElm.call(d3.drag<SVGRectElement, null>().on('drag', function (ev) {\r\n                var moverElm = d3.select(this);\r\n                var y = parseInt(moverElm.attr('y'));\r\n                var ny = y + ev.dy;\r\n                var h = parseInt(moverElm.attr('height'));\r\n\r\n                if (ny < 0 || ny + h > _this.height) {\r\n                    // out of range\r\n                    return;\r\n                }\r\n                moverElm.attr('y', ny);\r\n                _this._startPerc = ny / _this.height;\r\n                if (_this._onDrag) {\r\n                    _this._onDrag(_this._startPerc);\r\n                }\r\n            }));\r\n        } else {\r\n            this.moverElm = null;\r\n            this.scrollbarG.selectAll('*').remove();\r\n        }\r\n    \r\n    }\r\n    registerWheel(elm: d3.Selection<any, any, any, any>) {\r\n        const _this = this;\r\n        elm.on('wheel', function (ev) {\r\n            if (!_this.moverElm)\r\n                return;\r\n            var step = ev.deltaY > 0 ? 1 : -1;\r\n            ev.preventDefault();\r\n            ev.stopPropagation();\r\n            var y = parseInt(_this.moverElm.attr('y'));\r\n            var ny = Math.max(0, y + _this.barHeight * step);\r\n            var h = parseInt(_this.moverElm.attr('height'));\r\n\r\n            if (ny < 0 || ny + h > _this.height) {\r\n                // out of range\r\n                return;\r\n            }\r\n            _this.moverElm.attr('y', ny);\r\n            _this._startPerc = ny / _this.height;\r\n            if (_this._onDrag) {\r\n                _this._onDrag(_this._startPerc);\r\n            }\r\n        });\r\n        return this;\r\n    };\r\n    size(_width: number, _height: number) {\r\n        this.width = _width;\r\n        this.height = _height;\r\n        if (!Number.isFinite(this.height)) {\r\n            throw new Error('Can not resolve height of scrollbar');\r\n        }\r\n        if (!Number.isFinite(this.width)) {\r\n            throw new Error('Can not resolve width of scrollbar');\r\n        }\r\n        this.isScrollDisplayed();\r\n        if (this.scrollbarG) {\r\n            // redraw on size change\r\n            this.render();\r\n        }\r\n        if (this._onDrag) {\r\n\t        this._onDrag(this._startPerc);\r\n\t    }\r\n        return this;\r\n    }\r\n    isScrollDisplayed() {\r\n        if (this.flatenedData) { this._isScrollDisplayed = this.barHeight * this.flatenedData.length > this.height; }\r\n        return this._isScrollDisplayed;\r\n    }\r\n    data(_flatenedData:HierarchyNodeWaveGraphSignalWithXYId[], _maxDepth: number) {\r\n        this.flatenedData = _flatenedData;\r\n        this.maxDepth = _maxDepth;\r\n        this.isScrollDisplayed();\r\n        if (this.scrollbarG) {\r\n            // redraw on size change\r\n            this.render();\r\n        }\r\n        return this;\r\n    }\r\n    startPerc() {\r\n        return this._startPerc;\r\n    }\r\n}","import * as d3 from 'd3';\r\nimport { Scrollbar } from './scrollbar';\r\nimport { SignalLabelManipulation } from './signalLabelManipulation';\r\nimport { faChevronRight, faChevronDown } from '@fortawesome/free-solid-svg-icons';\r\nimport type { SignalContextMenu } from './signalLabelContextMenu';\r\nimport { WaveGraphSignal } from './data';\r\nimport { DragBarVertical } from './dragBar';\r\n\r\nexport interface HierarchyNodeWaveGraphSignalWithXYId extends d3.HierarchyNode<WaveGraphSignal> {\r\n\tx?: number;\r\n\ty?: number;\r\n\t_children?: this[];\r\n}\r\n/*\r\n * :ivar barHeight: Height of a single item in the list.\r\n * :ivar labelMoving: Object which is implementing moving of bars (drag&drop)\r\n * :ivar width: total width of a whole emement with a tree list\r\n * :ivar height: total height of a whole emement with a tree list\r\n * :ivar root: object whith hierarchical data which is displayed \r\n * :ivar rootElm: element where this element is placed\r\n * :ivar labelG: main SVG G  \r\n * \r\n **/\r\nexport class TreeList {\r\n\tbarHeight: number;\r\n\tlabelMoving: SignalLabelManipulation;\r\n\twidth: number | undefined;\r\n\theight: number | undefined;\r\n\troot: HierarchyNodeWaveGraphSignalWithXYId | null;\r\n\trootElm: d3.Selection<SVGGElement, undefined, HTMLDivElement, undefined> | null;\r\n\tlabelG: d3.Selection<SVGGElement, undefined, HTMLDivElement, undefined> | null;\r\n\tscrollbarG: d3.Selection<SVGGElement, any, any, any> | null;\r\n\tscroll: Scrollbar | null;\r\n\tcontextMenu: SignalContextMenu;\r\n\tnodes:HierarchyNodeWaveGraphSignalWithXYId[];\r\n\t_onChange: ((nodes: HierarchyNodeWaveGraphSignalWithXYId[]) => void) | null;\r\n\r\n\tconstructor(barHeight: number, contextMenu: SignalContextMenu) {\r\n\t\tthis.barHeight = barHeight;\r\n\t\tthis.contextMenu = contextMenu;\r\n\t\tthis.root = null;\r\n\t\tthis.rootElm = null;\r\n\t\tthis.labelG = null;\r\n\t\tthis.scrollbarG = null;\r\n\t\tthis.scroll = null;\r\n\t\tthis.width = undefined;\r\n\t\tthis.height = undefined;\r\n\t\tthis._onChange = null;\r\n\t\tthis.nodes = [];\r\n\t\tthis.labelMoving = new SignalLabelManipulation(barHeight, this);\r\n\t}\r\n\r\n\tpublic static getExpandCollapseIcon(d: HierarchyNodeWaveGraphSignalWithXYId) {\r\n\t\tif (d.data.children || d.data._children) {\r\n\t\t\tvar ico = faChevronRight;\r\n\t\t\tif (d.children != null) {\r\n\t\t\t\tico = faChevronDown;\r\n\t\t\t}\r\n\t\t\treturn ico.icon[4];\r\n\t\t}\r\n\t\treturn '';\r\n\t}\r\n\tregisterExpandHandler<GElement extends SVGElement, PElement extends SVGElement, PDatum>(elm: d3.Selection<GElement, HierarchyNodeWaveGraphSignalWithXYId, PElement, PDatum>) {\r\n\t\tvar clickExpandCollapse = this.clickExpandCollapse.bind(this);\r\n\t\telm.on('click', function (ev, d) { clickExpandCollapse(ev, d, this); })\r\n\t\t\t.on('mousedown', function (ev) { ev.stopPropagation(); })\r\n\t\t\t.on('mouseup', function (ev) { ev.stopPropagation(); });\r\n\t\treturn elm;\r\n\t}\r\n\tclickExpandCollapse(ev: any, d: HierarchyNodeWaveGraphSignalWithXYId, elm: SVGElement) {\r\n\t\tev.stopPropagation();\r\n\t\tif (d.children || d._children) {\r\n\t\t\tif (d.children) {\r\n\t\t\t\td._children = d.children;\r\n\t\t\t\td.children = undefined;\r\n\t\t\t} else {\r\n\t\t\t\td.children = d._children;\r\n\t\t\t\td._children = undefined;\r\n\t\t\t}\r\n\t\t\td3.select<SVGElement, HierarchyNodeWaveGraphSignalWithXYId>(elm.parentElement as any as SVGElement)\r\n\t\t\t\t.select('path')\r\n\t\t\t\t.attr('d', TreeList.getExpandCollapseIcon);\r\n\t\t\tthis.update();\r\n\t\t}\r\n\t}\r\n\tresolveSelection() {\r\n\t\t// Compute the flattened node list.\r\n\t\tif (!this.root) {\r\n\t\t\t// no data\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst barHeight = this.barHeight;\r\n\t\tconst nodeTotalCnt = this.root.value as number;\r\n\t\tconst scrollPerc = this.scroll ? this.scroll.startPerc() : 0;\r\n\t\tconst start = Math.round(scrollPerc * nodeTotalCnt);\r\n\t\tconst end = Math.min(start + (this.height as number) / barHeight, nodeTotalCnt);\r\n\t\tlet index = -1;\r\n\t\tlet i = 0;\r\n\t\tconst nodes = this.nodes;\r\n\t\tnodes.splice(0, nodes.length); // clear\r\n\t\tthis.root.eachBefore((n: HierarchyNodeWaveGraphSignalWithXYId) => {\r\n\t\t\tif (i >= start && i <= end) {\r\n\t\t\t\tn.x = n.depth * 20;\r\n\t\t\t\tn.y = ++index * barHeight;\r\n\t\t\t\tnodes.push(n);\r\n\t\t\t}\r\n\t\t\ti++;\r\n\t\t});\r\n\t}\r\n\tdraw(_rootElm: d3.Selection<SVGGElement, undefined, HTMLDivElement, undefined>) {\r\n\t\tthis.rootElm = _rootElm;\r\n\t\tthis.labelG = _rootElm.append('g');\r\n\r\n\t\tthis.update();\r\n\t\t// construct scrollbar after main list in order to have in top\r\n\t\tthis.scrollbarG = this.rootElm.append('g')\r\n\t\t\t.attr('class', 'scrollbar');\r\n\r\n\t\tthis.scroll = new Scrollbar(this.barHeight, this.scrollbarG);\r\n\t\tthis._bindScrollData();\r\n\t\tvar update = this.update.bind(this);\r\n\t\tthis.scroll\r\n\t\t\t.registerWheel(this.rootElm)\r\n\t\t\t.onDrag(function (startPrec: number) { update(); });\r\n\t\tthis.scroll.size(this.width as number, this.height as number);\r\n\t}\r\n\t_setLabelWidth(_width: number) {\r\n\t\tvar barHeight = this.barHeight;\r\n\t\t// udpate width on all labels\r\n\t\tif (this.labelG) {\r\n\t\t\tthis.labelG.selectAll<SVGRectElement, HierarchyNodeWaveGraphSignalWithXYId>('.labelcell rect')\r\n\t\t\t\t.attr('width', function (d: HierarchyNodeWaveGraphSignalWithXYId) {\r\n\t\t\t\t\treturn _width - d.depth * 20 - barHeight / 2;\r\n\t\t\t\t});\r\n\t\t\tthis.labelG.selectAll<SVGPathElement, HierarchyNodeWaveGraphSignalWithXYId>(\".labelcell\")\r\n\t\t\t\t.style(\"clip-path\", function (d) {\r\n\t\t\t\t\tvar width = _width - d.depth * 20 - barHeight / 2;\r\n\t\t\t\t\treturn [\"polygon(\", 0, \"px \", 0, \"px, \",\r\n\t\t\t\t\t\t0, \"px \", barHeight, \"px, \",\r\n\t\t\t\t\t\twidth, \"px \", barHeight, \"px, \",\r\n\t\t\t\t\t\twidth, \"px \", 0, \"px)\"].join(\"\");\r\n\t\t\t\t});\r\n\t\t}\r\n\t}\r\n\tsize(_width: number, _height: number) {\r\n\t\tif (!arguments.length) { return [this.width, this.height]; }\r\n\t\tif (this.labelG && this.width !== _width) {\r\n\t\t\tthis._setLabelWidth(_width);\r\n\t\t}\r\n\t\tthis.width = _width;\r\n\t\tthis.height = _height;\r\n\t\tif (this.scroll) {\r\n\t\t\t// also automatically renders also this list\r\n\t\t\tthis.scroll.size(this.width, this.height);\r\n\t\t}\r\n\t\treturn this;\r\n\t}\r\n\t_bindScrollData() {\r\n\t\tif (!this.root)\r\n\t\t\tthrow new Error(\"this.root should be already initialized\")\r\n\t\tif (this.scroll) {\r\n\t\t\tconst flatenedData: HierarchyNodeWaveGraphSignalWithXYId[] = [];\r\n\t\t\tlet maxDepth = 0;\r\n\t\t\tthis.root.eachBefore(function (d) {\r\n\t\t\t\tflatenedData.push(d);\r\n\t\t\t\tmaxDepth = Math.max(maxDepth, d.depth);\r\n\t\t\t});\r\n\r\n\t\t\tthis.scroll.data(flatenedData, maxDepth);\r\n\t\t}\r\n\r\n\t}\r\n\tdata(_data: WaveGraphSignal) {\r\n\t\tthis.root = d3.hierarchy(_data, function (d: WaveGraphSignal) { return d.children; });\r\n\t\t// Compute the flattened node list.\r\n\t\tthis.root.sum(() => 1);\r\n\t\tvar i = 0;\r\n\t\tthis.root.eachBefore((n: HierarchyNodeWaveGraphSignalWithXYId) => {\r\n\t\t\t(n as any).id = i++;\r\n\t\t});\r\n\t\tthis._bindScrollData();\r\n\r\n\t\tif (this.rootElm) {\r\n\t\t\t// update rendered\r\n\t\t\tif (this.labelG)\r\n\t\t\t\tthis.labelG.selectAll<SVGRectElement, HierarchyNodeWaveGraphSignalWithXYId>('.labelcell').remove();\r\n\t\t\tthis.update();\r\n\t\t} else {\r\n\t\t\t// update before rendering\r\n\t\t\tthis.resolveSelection();\r\n\t\t\tif (this._onChange) {\r\n\t\t\t\tthis._onChange(this.nodes);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn this;\r\n\t}\r\n\tonChange(fn: ((nodes: HierarchyNodeWaveGraphSignalWithXYId[]) => void) | null) {\r\n\t\tif (arguments.length) {\r\n\t\t\tthis._onChange = fn;\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\treturn this._onChange;\r\n\t}\r\n\tvisibleNodes() {\r\n\t\treturn this.nodes;\r\n\t}\r\n\tfilter(predicate: (d: WaveGraphSignal) => boolean) {\r\n\t\tif (!this.root)\r\n\t\t\treturn;\r\n\t\tfunction remove(d: HierarchyNodeWaveGraphSignalWithXYId) {\r\n\t\t\tif (d.parent) {\r\n\t\t\t\tif (!d.parent.children) {\r\n\t\t\t\t\tthrow new Error(\"Parent must have children because we are searching it because of children\");\r\n\t\t\t\t}\r\n\t\t\t\tconst index = d.parent.children.indexOf(d);\r\n\t\t\t\tif (index < 0) {\r\n\t\t\t\t\tthrow new Error(\"Deleting something which is not there\");\r\n\t\t\t\t}\r\n\t\t\t\t// remove an item from a children on parent\r\n\t\t\t\td.parent.children.splice(index, 1);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar updated = false;\r\n\t\tthis.root.eachBefore(function (d: HierarchyNodeWaveGraphSignalWithXYId) {\r\n\t\t\tif (!predicate(d.data)) {\r\n\t\t\t\tremove(d);\r\n\t\t\t\tupdated = true;\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (updated) {\r\n\t\t\tthis.update();\r\n\t\t}\r\n\t}\r\n\tupdate() {\r\n\t\tthis.resolveSelection();\r\n\t\tif (!this.labelG)\r\n\t\t\treturn;\r\n\t\t// Update the nodes\r\n\t\tvar node = this.labelG.selectAll<SVGGElement, HierarchyNodeWaveGraphSignalWithXYId>('.labelcell')\r\n\t\t\t.data(this.nodes, (d: HierarchyNodeWaveGraphSignalWithXYId) => {\r\n\t\t\t\treturn d.id?.toString() as string;\r\n\t\t\t});\r\n\r\n\t\tvar nodeEnter = node.enter().append<SVGGElement>('g')\r\n\t\t\t.classed('labelcell', true)\r\n\t\t\t// .attr(\"transform\", () => \"translate(\" + source.y0 + \",\" + source.x0 + \")\") // for transition\r\n\t\t\t.classed('selected', function (d: HierarchyNodeWaveGraphSignalWithXYId) {\r\n\t\t\t\treturn !!d.data.type.isSelected;\r\n\t\t\t});\r\n\r\n\t\tvar barHeight = this.barHeight;\r\n\t\t// background rectangle for highlight\r\n\t\tnodeEnter.append<SVGRectElement>('rect')\r\n\t\t\t.attr('height', barHeight)\r\n\t\t\t.attr('x', barHeight / 2)\r\n\t\t\t.attr('y', -0.5 * barHeight);\r\n\r\n\t\t// adding arrows\r\n\t\tnodeEnter.append<SVGPathElement>('path')\r\n\t\t\t.attr('transform', 'translate(0,' + -(barHeight / 2) + ')' + ' scale(' + (barHeight / faChevronDown.icon[1] * 0.5) + ')')\r\n\t\t\t.attr('d', TreeList.getExpandCollapseIcon)\r\n\t\t\t.call(this.registerExpandHandler.bind(this));\r\n\r\n\t\t// background for expand arrow\r\n\t\tnodeEnter.append<SVGRectElement>('rect')\r\n\t\t\t.classed('expandable', function (this: SVGRectElement, d: HierarchyNodeWaveGraphSignalWithXYId): boolean {\r\n\t\t\t\treturn !!(d.data.children || d.data._children);\r\n\t\t\t})\r\n\t\t\t.attr('width', barHeight / 2)\r\n\t\t\t.attr('height', barHeight)\r\n\t\t\t.attr('transform', 'translate(0,' + -(barHeight / 2) + ')')\r\n\t\t\t.style('opacity', 0)\r\n\t\t\t.call(this.registerExpandHandler.bind(this));\r\n\r\n\t\t// adding file or folder names\r\n\t\tnodeEnter.append<SVGTextElement>('text')\r\n\t\t\t.attr('dy', 3.5)\r\n\t\t\t.attr('dx', 15)\r\n\t\t\t.text((d: HierarchyNodeWaveGraphSignalWithXYId) => d.data.name);\r\n\t\tnodeEnter\r\n\t\t\t.on('mouseover', function (this: SVGGElement, event: any, d: HierarchyNodeWaveGraphSignalWithXYId) {\r\n\t\t\t\tif (!this)\r\n\t\t\t\t\treturn;\r\n\t\t\t\td3.select(this)\r\n\t\t\t\t\t.classed('highlight', true);\r\n\t\t\t})\r\n\t\t\t.on('mouseout', function (this: SVGGElement, event: any, d: HierarchyNodeWaveGraphSignalWithXYId) {\r\n\t\t\t\tnodeEnter.classed('highlight', false);\r\n\t\t\t});\r\n\r\n\t\t// Transition nodes to their new position.\r\n\t\tnodeEnter.attr('transform', (d: any) => 'translate(' + d.x + ',' + d.y + ')');\r\n\t\tnode.attr('transform', (d: any) => 'translate(' + d.x + ',' + d.y + ')');\r\n\r\n\t\tnode.exit()\r\n\t\t\t.remove();\r\n\t\tconst contextmenu = this.contextMenu.render.bind(this.contextMenu);\r\n\t\tnodeEnter.on('contextmenu', function (this: SVGGElement, ev: any, d: HierarchyNodeWaveGraphSignalWithXYId) {\r\n\t\t\tcontextmenu(this, ev, d);\r\n\t\t});\r\n\t\tthis._setLabelWidth(this.width as number);\r\n\t\tif (this._onChange) {\r\n\t\t\tthis._onChange(this.nodes);\r\n\t\t}\r\n\t\tthis.labelMoving.registerDrag(\r\n\t\t\tthis.labelG.selectAll<SVGGElement, HierarchyNodeWaveGraphSignalWithXYId>('.labelcell')\r\n\t\t);\r\n\t}\r\n}\r\n","import * as d3 from 'd3';\r\n\r\n// http://bl.ocks.org/mccannf/1629464\r\nexport class DragBarVertical {\r\n\tx: number;\r\n\ty: number;\r\n\txMin: number;\r\n\txMax: number;\r\n\tdragBehavior: d3.DragBehavior<SVGRectElement, any, any>;\r\n\tdragHandle: d3.Selection<SVGRectElement, this, any, any>;\r\n\t_size: [number, number];\r\n\t_onDrag?: (drag: DragBarVertical) => void;\r\n\r\n\tconstructor(parentGElm: d3.Selection<SVGGElement, any, any, any>, size: [number, number], range: [number, number], init_pos: [number, number]) {\r\n\t\tthis._onDrag = undefined;\r\n\t\t[this.xMin, this.xMax] = range;\r\n\t\t[this.x, this.y] = init_pos;\r\n\t\tthis.dragBehavior = d3.drag<SVGRectElement, any, any>()\r\n\t\t\t.on('drag', this._onDragDelegate.bind(this));\r\n\t\tthis.dragHandle = parentGElm.append<SVGRectElement>(\"rect\")\r\n\t\t\t.data([this,])\r\n\t\t\t.classed('dragbar-vertical', true)\r\n\t\t\t.attr(\"fill\", \"lightblue\")\r\n\t\t\t.attr(\"fill-opacity\", .5)\r\n\t\t\t.attr(\"cursor\", \"ew-resize\")\r\n\t\t\t.call(this.dragBehavior);\r\n\r\n\t\tthis._size = [size[0], size[1]];\r\n\t\tthis.size(size[0], size[1]);\r\n\t}\r\n\trange(xMin: number, xMax: number) {\r\n\t\tif (arguments.length) {\r\n\t\t\t[this.xMin, this.xMax] = [xMin, xMax];\r\n\t\t} else {\r\n\t\t\treturn [this.xMin, this.xMax];\r\n\t\t}\r\n\t}\r\n\tsize(width: number, height: number) {\r\n\t\tif (arguments.length) {\r\n\t\t\tthis._size = [width, height];\r\n\t\t\tif (width > 0 && height > 0) {\r\n\t\t\t\tthis.dragHandle\r\n\t\t\t\t\t.attr(\"x\", function (d) { return d.x - (width / 2); })\r\n\t\t\t\t\t.attr(\"y\", function (d) { return d.y; })\r\n\t\t\t\t\t.attr(\"height\", height)\r\n\t\t\t\t\t.attr(\"width\", width);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\treturn this._size;\r\n\t\t}\r\n\t}\r\n\t_onDragDelegate(ev: d3.D3DragEvent<SVGRectElement, this, any>, d: this) {\r\n\t\tvar width = this._size[0];\r\n\t\tvar dragx = Math.max(\r\n\t\t\tthis.xMin + (width / 2),\r\n\t\t\tMath.min(this.xMax, d.x + ev.dx + (width / 2))\r\n\t\t);\r\n\t\tthis.x = dragx - (width / 2);\r\n\t\tthis.dragHandle\r\n\t\t\t.attr(\"x\", function (d) { return d.x });\r\n\t\tif (this._onDrag)\r\n\t\t\tthis._onDrag(this);\r\n\t}\r\n\tonDrag(_onDrag?: (drag: DragBarVertical) => void) {\r\n\t\tif (arguments.length) {\r\n\t\t\tthis._onDrag = _onDrag;\r\n\t\t\treturn this;\r\n\t\t} else {\r\n\t\t\treturn this._onDrag;\r\n\t\t}\r\n\t}\r\n}","// https://stackoverflow.com/questions/15181452/how-to-save-export-inline-svg-styled-with-css-from-browser-to-image-file\r\n\r\nfunction inlineStylesToSvgCopy(parentNode: SVGElement, origData: SVGElement,\r\n\tCONTAINER_ELEMENTS: string[],\r\n\tRELEVANT_STYLES: { [elmTag: string]: string[] }) {\r\n\r\n\tif (parentNode.tagName in RELEVANT_STYLES) {\r\n\t\tvar StyleDef = window.getComputedStyle(origData);\r\n\t\tvar styleStrBuff = [];\r\n\t\tvar relStyles = RELEVANT_STYLES[parentNode.tagName];\r\n\t\tfor (var st = 0; st < relStyles.length; st++) {\r\n\t\t\tstyleStrBuff.push(relStyles[st]);\r\n\t\t\tstyleStrBuff.push(':');\r\n\t\t\tstyleStrBuff.push(StyleDef.getPropertyValue(relStyles[st]));\r\n\t\t\tstyleStrBuff.push('; ');\r\n\t\t}\r\n\t\tparentNode.setAttribute('style', styleStrBuff.join(''));\r\n\t}\r\n\tif (CONTAINER_ELEMENTS.indexOf(parentNode.tagName) === -1)\r\n\t\treturn;\r\n\tconst children = parentNode.childNodes;\r\n\tconst origChildDat = origData.childNodes;\r\n\tfor (let cd = 0; cd < children.length; cd++) {\r\n\t\tconst c = children[cd];\r\n\t\tinlineStylesToSvgCopy(c as SVGElement, origChildDat[cd] as SVGElement, CONTAINER_ELEMENTS, RELEVANT_STYLES);\r\n\t}\r\n}\r\n\r\nconst CONTAINER_ELEMENTS = ['svg', 'g'];\r\nconst RELEVANT_STYLES = {\r\n\t'svg': ['background-color',],\r\n\t'rect': ['fill', 'stroke', 'stroke-width', 'opacity'],\r\n\t'path': ['fill', 'stroke', 'stroke-width', 'stroke-dasharray', 'opacity'],\r\n\t'circle': ['fill', 'stroke', 'stroke-width', 'stroke-dasharray', 'opacity'],\r\n\t'line': ['stroke', 'stroke-width', 'stroke-dasharray', 'opacity'],\r\n\t'text': ['fill', 'font-size', 'text-anchor', 'opacity'],\r\n\t'polygon': ['fill', 'stroke', 'stroke-width', 'stroke-dasharray', 'opacity']\r\n};\r\n\r\nexport function exportStyledSvgToBlob(svgElm: SVGSVGElement) {\r\n\tconst oDOM = svgElm.cloneNode(true);\r\n\tinlineStylesToSvgCopy(oDOM as SVGElement, svgElm, CONTAINER_ELEMENTS, RELEVANT_STYLES);\r\n\r\n\tconst data = new XMLSerializer().serializeToString(oDOM);\r\n\tconst svg = new Blob([data], { type: 'image/svg+xml;charset=utf-8' });\r\n\treturn svg;\r\n}\r\n","function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","// https://github.com/patorjk/d3-context-menu v1.1.2 modified to be bundable\r\nimport * as d3 from 'd3';\r\nimport './d3-context-menu.css';\r\n\r\n\r\ndeclare type ValOrGetter<T, retT> = retT | ((menu: ContextMenu<T>, elment: SVGGElement, data: ContextMenuItem<T>, index: number) => retT);\r\n\r\nexport class ContextMenuItem<T> {\r\n\ttitle: ValOrGetter<T, string>;\r\n\tdata: T;\r\n\tchildren: ValOrGetter<T, ContextMenuItem<any>[]>;\r\n\tdivider: ValOrGetter<T, boolean>;\r\n\tdisabled: ValOrGetter<T, boolean>;\r\n\taction: null | ((menu: ContextMenu<T>, elment: SVGGElement, data: ContextMenuItem<T>, index: number) => void);\r\n\r\n\tconstructor(\r\n\t\ttitle: ValOrGetter<T, string>,\r\n\t\tdata: T,\r\n\t\tchildren: ValOrGetter<T, ContextMenuItem<any>[]>,\r\n\t\tdivider: ValOrGetter<T, boolean>,\r\n\t\tdisabled: ValOrGetter<T, boolean>,\r\n\t\taction: null | ((menu: ContextMenu<T>, elment: SVGGElement,  data: ContextMenuItem<T>, index: number) => void),\r\n\t\t) {\r\n\t\tthis.title = title;\r\n\t\tthis.children = children;\r\n\t\tthis.divider = divider;\r\n\t\tthis.disabled = disabled;\r\n\t\tthis.action = action;\r\n\t\tthis.data = data;\r\n\t}\r\n};\r\n\r\nexport class LeftTop {\r\n\tleft: number;\r\n\ttop: number;\r\n\tconstructor(left: number, top: number) {\r\n\t\tthis.left = left;\r\n\t\tthis.top = top;\r\n\t}\r\n}\r\n\r\nlet ContextMenu_currentlyShownInstance: ContextMenu<any> | null = null;\r\n\r\nexport class ContextMenu<T> {\r\n\r\n\tconstructor() {\r\n\t}\r\n\t//public static noop() { }\r\n\r\n\tpublic static isFn(value: any): boolean {\r\n\t\treturn typeof value === 'function';\r\n\t}\r\n\r\n\t//public static const(value: any): () => any {\r\n\t//\treturn function() { return value; };\r\n\t//}\r\n\r\n\t//public static toFactory<T>(value: T, fallback: T): T {\r\n\t//\tvalue = (value === undefined) ? fallback : value;\r\n\t//\treturn ContextMenu.isFn(value) ? value : ContextMenu.const(value) as T;\r\n\t//}\r\n\tgetMenuItems(d: ContextMenuItem<T>): ContextMenuItem<any>[] {\r\n\t\tthrow new Error(\"Override this method in your implementation of this class\");\r\n\t}\r\n\r\n\tonOpen(element: SVGGElement, data: T): boolean {\r\n\t\treturn true;\r\n\t}\r\n\tonClose() {\r\n\t}\r\n\tgetTheme(element: SVGGElement, data: T) {\r\n\t\treturn 'd3-context-menu-theme';\r\n\t}\r\n\tgetPosition(element: SVGGElement, data: T): LeftTop | undefined {\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tcloseMenu() {\r\n\t\t// global state is populated if a menu is currently opened\r\n\t\tif (ContextMenu_currentlyShownInstance) {\r\n\t\t\td3.select('.d3-context-menu').remove();\r\n\t\t\td3.select('body').on('mousedown.d3-context-menu', null);\r\n\t\t\tContextMenu_currentlyShownInstance.onClose();\r\n\t\t\tContextMenu_currentlyShownInstance = null;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Context menu event handler\r\n\t * @param {*} data\r\n\t */\r\n\trender(element: SVGGElement, ev: any, data: T) {\r\n\t\t// close any menu that's already opened\r\n\t\tthis.closeMenu();\r\n\r\n\t\t// store close callback already bound to the correct args and scope\r\n\t\tContextMenu_currentlyShownInstance = this;\r\n\r\n\t\t// create the div element that will hold the context menu\r\n\t\td3.selectAll('.d3-context-menu').data([new ContextMenuItem(\"\", data, [], false, false, null)])\r\n\t\t\t.enter()\r\n\t\t\t.append('div')\r\n\t\t\t.attr('class', 'd3-context-menu ' + this.getTheme(element, data));\r\n\r\n\t\tconst closeMenu = this.closeMenu.bind(this)\r\n\t\t// close menu on mousedown outside\r\n\t\td3.select('body').on('mousedown.d3-context-menu', closeMenu);\r\n\t\td3.select('body').on('click.d3-context-menu', closeMenu);\r\n\r\n\t\tconst parent = d3.selectAll('.d3-context-menu')\r\n\t\t\t.on('contextmenu', function (ev) {\r\n\t\t\t\tcloseMenu();\r\n\t\t\t\tev.preventDefault();\r\n\t\t\t\tev.stopPropagation();\r\n\t\t\t})\r\n\t\t\t.append('ul');\r\n\r\n\t\tparent.call(this._renderNestedMenu.bind(this), element);\r\n\r\n\t\t// the openCallback allows an action to fire before the menu is displayed\r\n\t\t// an example usage would be closing a tooltip\r\n\t\tif (this.onOpen(element, data) === false) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Use this if you want to align your menu from the containing element, otherwise aligns towards center of window\r\n\t\t//console.log(this.parentNode.parentNode.parentNode);//.getBoundingClientRect());\r\n\r\n\t\t// get position\r\n\t\tconst position = this.getPosition(element, data);\r\n\r\n\t\tconst doc = document.documentElement;\r\n\t\tconst pageWidth = window.innerWidth || doc.clientWidth;\r\n\t\tconst pageHeight = window.innerHeight || doc.clientHeight;\r\n\r\n\t\tlet horizontalAlignment = 'left';\r\n\t\tlet horizontalAlignmentReset = 'right';\r\n\t\tlet horizontalValue = position ? position.left : ev.pageX - 2;\r\n\t\tif (ev.pageX > pageWidth / 2) {\r\n\t\t\thorizontalAlignment = 'right';\r\n\t\t\thorizontalAlignmentReset = 'left';\r\n\t\t\thorizontalValue = position ? pageWidth - position.left : pageWidth - ev.pageX - 2;\r\n\t\t}\r\n\r\n\r\n\t\tlet verticalAlignment = 'top';\r\n\t\tlet verticalAlignmentReset = 'bottom';\r\n\t\tlet verticalValue = position ? position.top : ev.pageY - 2;\r\n\t\tif (ev.pageY > pageHeight / 2) {\r\n\t\t\tverticalAlignment = 'bottom';\r\n\t\t\tverticalAlignmentReset = 'top';\r\n\t\t\tverticalValue = position ? pageHeight - position.top : pageHeight - ev.pageY - 2;\r\n\t\t}\r\n\r\n\t\t// display context menu\r\n\t\td3.select('.d3-context-menu')\r\n\t\t\t.style(horizontalAlignment, (horizontalValue) + 'px')\r\n\t\t\t.style(horizontalAlignmentReset, null)\r\n\t\t\t.style(verticalAlignment, (verticalValue) + 'px')\r\n\t\t\t.style(verticalAlignmentReset, null)\r\n\t\t\t.style('display', 'block');\r\n\r\n\t\tev.preventDefault();\r\n\t\tev.stopPropagation();\r\n\t}\r\n\r\n\t_renderNestedMenu(parent: d3.Selection<HTMLUListElement, any, any, any>, root: SVGGElement, depth: number = 0) {\r\n\t\tconst _this = this;\r\n\t\tfunction resolve<retT> (value: ValOrGetter<T, retT>, data: ContextMenuItem<T>, index: number) : retT {\r\n\t\t\tif (ContextMenu.isFn(value)) {\r\n\t\t\t\tconst valFn = value as ((menu: ContextMenu<T>, elment: SVGGElement, data: ContextMenuItem<any>, index: number) => retT);\r\n\t\t\t\treturn valFn(_this, root, data, index);\r\n\t\t\t} else {\r\n\t\t\t\treturn value as retT;\r\n\t\t\t}\r\n\t\t};\r\n\t\tconst closeMenu = this.closeMenu.bind(this)\r\n\r\n\t\tparent.selectAll('li')\r\n\t\t\t.data((d: ContextMenuItem<any>) => {\r\n\t\t\t\tif (depth == 0) {\r\n\t\t\t\t\treturn _this.getMenuItems(d as ContextMenuItem<T>);\r\n\t\t\t\t} else {\r\n\t\t\t\t    return resolve<ContextMenuItem<any>[]>(d.children, d as ContextMenuItem<any>, 0);\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t.enter()\r\n\t\t\t.append('li')\r\n\t\t\t.each(function (d: ContextMenuItem<T>, i: number) {\r\n\t\t\t\t// get value of each data\r\n\t\t\t\tvar isDivider = !!resolve(d.divider, d, i);\r\n\t\t\t\tvar isDisabled = !!resolve(d.disabled, d, i);\r\n\t\t\t\tvar hasChildren = resolve(d.children, d, i).length != 0;\r\n\t\t\t\tvar hasAction = !!d.action;\r\n\t\t\t\tvar text = isDivider ? '<hr/>' : resolve(d.title, d, i);\r\n\r\n\t\t\t\tvar listItem = d3.select<HTMLLIElement, ContextMenuItem<any>>(this)\r\n\t\t\t\t\t.classed('is-divider', isDivider)\r\n\t\t\t\t\t.classed('is-disabled', isDisabled)\r\n\t\t\t\t\t.classed('is-header', !hasChildren && !hasAction)\r\n\t\t\t\t\t.classed('is-parent', hasChildren)\r\n\t\t\t\t\t.html(text)\r\n\t\t\t\t\t.on('click', function (this: HTMLLIElement, ev: any, data: ContextMenuItem<any>) {\r\n\t\t\t\t\t\t// do nothing if disabled or no action\r\n\t\t\t\t\t\tif (isDisabled || !hasAction) return;\r\n\t\t\t\t\t\tif (!d.action)\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\td.action(_this, root, data, 0);\r\n\t\t\t\t\t\tcloseMenu();\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\tif (!isDisabled && hasChildren) {\r\n\t\t\t\t\t// create children(`next parent`) and call recursive\r\n\t\t\t\t\tvar children = listItem.append('ul')\r\n\t\t\t\t\t\t.classed('is-children', true);\r\n\t\t\t\t\t_this._renderNestedMenu(children, root, ++depth)\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t}\r\n}\r\n","import type { WaveGraph } from './waveGraph';\r\nimport { ContextMenu, ContextMenuItem } from './contextMenu';\r\nimport type { HierarchyNodeWaveGraphSignalWithXYId } from './treeList';\r\n\r\nexport class SignalContextMenu extends ContextMenu<HierarchyNodeWaveGraphSignalWithXYId> {\r\n\twaveGraph: WaveGraph;\r\n\tconstructor(waveGraph: WaveGraph) {\r\n\t\tsuper();\r\n\t\tthis.waveGraph = waveGraph;\r\n\t}\r\n\tgetMenuItems(d: ContextMenuItem<HierarchyNodeWaveGraphSignalWithXYId>): ContextMenuItem<any>[] {\r\n\t\tlet waveGraph = this.waveGraph;\r\n\t\tlet formatOptions: ContextMenuItem<string>[] = [];\r\n\t\t// construct format options from values in formatters dictionary\r\n\r\n\t\tvar formatters = d.data.data.type.renderer?.FORMATTERS || {};\r\n\t\tfunction formatChanger(cm: ContextMenu<string>,\r\n\t\t\telm: SVGGElement,\r\n\t\t\tdata: ContextMenuItem<string>,\r\n\t\t\tindex: number) {\r\n\t\t\tconst key = data.data;\r\n\t\t\t// function which switches data format function on every currently selected signals\r\n\t\t\tconst newFormatter = formatters[key];\r\n\t\t\td.data.data.type.formatter = newFormatter;\r\n\t\t\tconst currentRenderrer = d.data.data.type.renderer;\r\n\t\t\twaveGraph.treelist?.visibleNodes().forEach(function (d: HierarchyNodeWaveGraphSignalWithXYId) {\r\n\t\t\t\tif (d.data.type.isSelected && d.data.type.renderer === currentRenderrer) {\r\n\t\t\t\t\t// === currentRenderrer because we do not want to change format on signals\r\n\t\t\t\t\t// which do not support this format option\r\n\t\t\t\t\td.data.type.formatter = newFormatter;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\twaveGraph.draw();\r\n\t\t}\r\n\r\n\t\tfor (var key in formatters) {\r\n\t\t\tif (formatters.hasOwnProperty(key)) {\r\n\t\t\t\tformatOptions.push(new ContextMenuItem<string>(\r\n\t\t\t\t\t/*title*/ key,\r\n\t\t\t\t\tkey,\r\n\t\t\t\t\t[],\r\n\t\t\t\t\t/* divider */ false,\r\n\t\t\t\t\t/* disabled */ false,\r\n\t\t\t\t\t/*action*/ formatChanger,\r\n\t\t\t\t));\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t// Helper function to check if signal is multi-bit\r\n\t\tfunction isMultiBitSignal(signal: HierarchyNodeWaveGraphSignalWithXYId): boolean {\r\n\t\t\t//check if the \"data\" section has a b at the start of the string\r\n\t\t\treturn typeof signal.data === 'string' && (signal.data as string).startsWith('b');\r\n\t\t}\r\n\r\n\t\tfunction breakDownSignal(){\r\n\r\n\t\t}\r\n\t\t/*\r\n\t\t// Helper function to parse binary string (e.g., \"b00101\") to decimal\r\n\t\tfunction parseBinaryString(binaryStr: string): number {\r\n\t\t\t// Remove the 'b' prefix and convert to decimal\r\n\t\t\tif (binaryStr.startsWith('b')) {\r\n\t\t\t\treturn parseInt(binaryStr.substring(1), 2);\r\n\t\t\t}\r\n\t\t\t// Handle 'X' values (undefined/don't care) as 0 or however you want to represent them\r\n\t\t\tif (binaryStr.includes('X')) {\r\n\t\t\t\treturn -1; // Or another special value to indicate \"don't care\"\r\n\t\t\t}\r\n\t\t\treturn parseInt(binaryStr, 2);\r\n\t\t}\r\n\t\t\r\n\t\t// Function to break down a multi-bit signal into individual bits\r\n\t\tfunction breakDownSignal(cm: ContextMenu<HierarchyNodeWaveGraphSignalWithXYId>,\r\n\t\t\telm: SVGGElement,\r\n\t\t\tdata: ContextMenuItem<HierarchyNodeWaveGraphSignalWithXYId>,\r\n\t\t\tindex: number) {\r\n\t\t\t\r\n\t\t\tconst signal = data.data;\r\n\t\t\tconst signalWidth = signal.data.data.type.width;\r\n\t\t\t\r\n\t\t\tif (!isMultiBitSignal(signal)) {\r\n\t\t\t\treturn; // Don't process single-bit signals\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// Create individual bit signals for each bit position\r\n\t\t\tfor (let i = 0; i < signalWidth; i++) {\r\n\t\t\t\t// Create a new signal for this bit\r\n\t\t\t\tconst bitSignal = structuredClone(signal); // Deep clone the signal\r\n\t\t\t\t\r\n\t\t\t\t// Update properties for this specific bit\r\n\t\t\t\tbitSignal.data.id = `${signal.data.id}_bit${i}`; // Unique ID\r\n\t\t\t\tbitSignal.data.name = `${signal.data.name}[${i}]`; // Add bit index to name\r\n\t\t\t\tbitSignal.data.data.type.width = 1; // Set width to 1 bit\r\n\t\t\t\tbitSignal.data.data.originalSignal = signal.data.id; // Store reference to parent\r\n\t\t\t\tbitSignal.data.data.bitIndex = i; // Store bit index\r\n\t\t\t\t\r\n\t\t\t\t// Process data points for this bit\r\n\t\t\t\tconst newData = [];\r\n\t\t\t\tfor (const dataPoint of signal.data.data.data) {\r\n\t\t\t\t\tconst time = dataPoint[0];\r\n\t\t\t\t\tlet value = dataPoint[1];\r\n\t\t\t\t\t\r\n\t\t\t\t\t// Handle different data formats\r\n\t\t\t\t\tlet bitValue;\r\n\t\t\t\t\tif (typeof value === 'string' && value.startsWith('b')) {\r\n\t\t\t\t\t\t// Handle binary string (e.g., \"b00101\")\r\n\t\t\t\t\t\tconst binaryStr = value.substring(1); // Remove 'b' prefix\r\n\t\t\t\t\t\tconst padded = binaryStr.padStart(signalWidth, '0');\r\n\t\t\t\t\t\t// Extract the specific bit (reverse order since LSB is rightmost)\r\n\t\t\t\t\t\tconst bit = padded[padded.length - 1 - i];\r\n\t\t\t\t\t\tbitValue = bit === 'X' ? 'X' : bit; // Preserve 'X' if present\r\n\t\t\t\t\t} else if (typeof value === 'number') {\r\n\t\t\t\t\t\t// Handle numeric value\r\n\t\t\t\t\t\tbitValue = ((value >> i) & 1).toString();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// Handle any other format (e.g., if data is already in bit form)\r\n\t\t\t\t\t\tbitValue = value;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tnewData.push([time, bitValue]);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// Set the processed data for this bit\r\n\t\t\t\tbitSignal.data.data.data = newData;\r\n\t\t\t\t\r\n\t\t\t\t// Add the bit signal to the waveGraph tree\r\n\t\t\t\twaveGraph.addSignal(bitSignal);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\twaveGraph.draw();\r\n\t\t}*/\r\n\t\t\r\n\t\treturn [\r\n\t\t\tnew ContextMenuItem<HierarchyNodeWaveGraphSignalWithXYId>(\r\n\t\t\t\t'Remove',\r\n\t\t\t\td.data,\r\n\t\t\t\t[], false, false,\r\n\t\t\t\t/*action*/(cm: ContextMenu<HierarchyNodeWaveGraphSignalWithXYId>,\r\n\t\t\t\t\telm: SVGGElement,\r\n\t\t\t\t\tdata: ContextMenuItem<HierarchyNodeWaveGraphSignalWithXYId>,\r\n\t\t\t\t\tindex: number) => {\r\n\t\t\t\t\td.data.data.type.isSelected = true;\r\n\t\t\t\t\treturn waveGraph.treelist?.filter((d) => {\r\n\t\t\t\t\t\treturn !d.type.isSelected;\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t),\r\n\t\t\tnew ContextMenuItem<HierarchyNodeWaveGraphSignalWithXYId>(\r\n\t\t\t\t'Format',\r\n\t\t\t\td.data,\r\n\t\t\t\t/* children */ formatOptions,\r\n\t\t\t\t/* divider */ false,\r\n\t\t\t\t/* disabled */ formatOptions.length == 0,\r\n\t\t\t\t/*action*/ null,\r\n\t\t\t),\r\n\t\t\tnew ContextMenuItem<HierarchyNodeWaveGraphSignalWithXYId>(\r\n\t\t\t\t'Break down',\r\n\t\t\t\td.data,\r\n\t\t\t\t[], // No children\r\n\t\t\t\tfalse, // No divider\r\n\t\t\t\t!isMultiBitSignal(d.data), // Disable if not multi-bit\r\n\t\t\t\tbreakDownSignal // Action to perform\r\n\t\t\t)\r\n\t\t];\r\n\t\t\r\n\t}\r\n}","import * as d3 from 'd3';\r\n\r\n\r\nexport class Tooltip {\r\n\ttooltipHtmlGetter: (d: any) => string;\r\n\ttooltipDiv: d3.Selection<HTMLDivElement, unknown, HTMLElement, any>;\r\n\r\n\tconstructor(tooltipHtmlGetter: (d: any) => string) {\r\n\t\tthis.tooltipHtmlGetter = tooltipHtmlGetter;\r\n\t\tthis.tooltipDiv = d3.select('body').append('div')\r\n\t\t\t.attr('class', 'd3-wave tooltip')\r\n\t\t\t.style('opacity', 0)\r\n\t\t\t.style('display', 'none');\r\n\t}\r\n\r\n\taddToElm(selection: d3.Selection<any, any, any, any>) {\r\n\t\tvar tooltipDiv = this.tooltipDiv;\r\n\t\tvar tooltipHtmlGetter = this.tooltipHtmlGetter;\r\n\t\treturn selection\r\n\t\t\t.on('mouseover', function(ev, d) {\r\n\t\t\t\ttooltipDiv.transition()\r\n\t\t\t\t\t.duration(200)\r\n\t\t\t\t\t.style('display', 'block')\r\n\t\t\t\t\t.style('opacity', 0.9);\r\n\t\t\t\tvar tootipHtml = tooltipHtmlGetter(d)\r\n\t\t\t\ttooltipDiv.html(tootipHtml)\r\n\t\t\t\t\t.style('left', (ev.pageX) + 'px')\r\n\t\t\t\t\t.style('top', (ev.pageY - 28) + 'px');\r\n\t\t\t})\r\n\t\t\t.on('mouseout', function() {\r\n\t\t\t\ttooltipDiv.transition()\r\n\t\t\t\t\t.duration(500)\r\n\t\t\t\t\t.style('opacity', 0)\r\n\t\t\t\t\t.style('display', 'none');\r\n\t\t\t});\r\n\t}\r\n}","\r\nexport class WaveGraphSizesRow {\r\n\t// currently used time range\r\n\trange: [number, number];\r\n\theight: number;\r\n\typadding: number;\r\n\tconstructor() {\r\n\t\tthis.range = [0, 1];\r\n\t\tthis.height = 20;\r\n\t\tthis.ypadding = 5;\r\n\t}\r\n}\r\n\r\nexport class WaveGraphSizesMargin {\r\n\ttop: number;\r\n\tright: number;\r\n\tbottom: number;\r\n\tleft: number;\r\n\tconstructor() {\r\n\t\tthis.top = 20;\r\n\t\tthis.right = 20;\r\n\t\tthis.bottom = 20;\r\n\t\tthis.left = 180;\r\n\t}\r\n}\r\n\r\nexport class WaveGraphSizes {\r\n\trow: WaveGraphSizesRow;\r\n\tmargin: WaveGraphSizesMargin;\r\n\tdragWidth: number;\r\n\twidth: number;\r\n\theight: number;\r\n\tconstructor() {\r\n\t\tthis.row = new WaveGraphSizesRow();\r\n\t\tthis.margin = new WaveGraphSizesMargin();\r\n\t\tthis.dragWidth = 5;\r\n\t\tthis.width = -1;\r\n\t\tthis.height = -1;\r\n\t}\r\n};\r\n","import * as d3 from 'd3';\r\nimport { filterDataByTime } from './filterData';\r\nimport { RowRendererBase } from './rowRenderers/base';\r\nimport { RowRendererBit } from './rowRenderers/bit';\r\nimport { RowRendererBits } from './rowRenderers/bits';\r\nimport { RowRendererEnum } from './rowRenderers/enum';\r\nimport { RowRendererLabel } from './rowRenderers/label';\r\nimport { RowRendererStruct } from './rowRenderers/struct';\r\nimport { RowRendererArray } from './rowRenderers/array';\r\nimport { createTimeFormatterForTimeRange } from './timeFormat';\r\nimport { TreeList } from './treeList';\r\nimport { faQuestion, faDownload, faArrowsH, faFilter } from '@fortawesome/free-solid-svg-icons';\r\nimport { DragBarVertical } from './dragBar';\r\nimport { exportStyledSvgToBlob } from './exportSvg'\r\nimport { SignalContextMenu } from './signalLabelContextMenu';\r\nimport { Tooltip } from './tooltip';\r\nimport { WaveGraphSignal } from './data'\r\nimport { WaveGraphSizes } from './sizes';\r\n\r\nimport './d3-wave.css';\r\n\r\n\r\n// main class which constructs the signal wave viewer\r\nexport class WaveGraph {\r\n\tsvg: d3.Selection<SVGSVGElement, undefined, HTMLDivElement, undefined>; // main SVG element where this graph is rendered\r\n\tdataG: d3.Selection<SVGGElement, undefined, HTMLDivElement, undefined>; // main svg g where signal values are rendered\r\n\r\n\twaveRowX: d3.ScaleLinear<number, number, never> | null; // stace to resolve X position from time in dataG\r\n\twaveRowY: d3.ScaleLinear<number, number, never> | null; // scale to resolve Y position from signal list index in dataG\r\n\txAxis: d3.Axis<d3.NumberValue> | null;\r\n\tyAxisG: d3.Selection<SVGGElement, undefined, HTMLDivElement, undefined> | null;\r\n\txAxisG: d3.Selection<SVGGElement, undefined, HTMLDivElement, undefined> | null;\r\n\txRange: [number, number]; // range of x axis (time)\r\n\r\n\tsizes: WaveGraphSizes; // container of all sizes, padings, margings etc. \r\n\tTICKS_PER_X_AXIS: number;\r\n\trowRenderers: RowRendererBase[]; // renderers which are used to convert signal values to a displayed graphical element\r\n\r\n\ttimeZoom: d3.ZoomBehavior<SVGGElement, undefined> | null; // zoom in time axis for displayed signal values\r\n\ttreelist: TreeList | null; // tree list which displays signal hiearchy an implements signal manimulations\r\n\tverticalHelpLine: d3.Selection<SVGLineElement, undefined, HTMLDivElement, undefined> | null; // line which appears under cursor an can be used as a ruler\r\n\tlabelAreaSizeDragBar: DragBarVertical | null; // dragbar which can be used to make signal label section wider\r\n\tlabelContextMenu: SignalContextMenu; // menu which appears on RMB click on signal label, containing formating options, delete etc. \r\n\r\n\tdata: WaveGraphSignal[]; // flattened list of all displayed signals\r\n\t_allData?: WaveGraphSignal; // all data which were originaly assigned to this graph\r\n\r\n\tconstructor(svg: d3.Selection<SVGSVGElement, undefined, HTMLDivElement, undefined>) {\r\n\t\tthis.svg = svg;\r\n\t\tsvg.classed('d3-wave', true);\r\n\t\tthis.dataG = svg.append('g');\r\n\t\tthis.xAxis = null;\r\n\t\tthis.yAxisG = null;\r\n\t\tthis.xAxisG = null;\r\n\t\tthis.waveRowX = null;\r\n\t\tthis.waveRowY = null;\r\n\t\tthis.verticalHelpLine = null;\r\n\r\n\t\t// total time range\r\n\t\tthis.xRange = [0, 1];\r\n\t\tthis.sizes = new WaveGraphSizes();\r\n\t\tthis.TICKS_PER_X_AXIS = 10; // number of ticks in X (time) axis\r\n\t\tthis.data = [];\r\n\t\tthis._allData = undefined;\r\n\r\n\t\t// list of renderers for value rows\r\n\t\tthis.rowRenderers = [\r\n\t\t\tnew RowRendererBit(this),\r\n\t\t\tnew RowRendererBits(this),\r\n\t\t\tnew RowRendererEnum(this),\r\n\t\t\tnew RowRendererLabel(this),\r\n\t\t\tnew RowRendererStruct(this),\r\n\t\t\tnew RowRendererArray(this),\r\n\t\t];\r\n\t\tthis.timeZoom = null;\r\n\t\tthis.labelAreaSizeDragBar = null;\r\n\t\tthis.labelContextMenu = new SignalContextMenu(this);\r\n\t\tthis.setSizes();\r\n\t\tthis.treelist = null;\r\n\t}\r\n\r\n\t_setZoom() {\r\n\t\tconst timeRange = this.xRange;\r\n\t\tconst _thisWaveGraph = this;\r\n\t\tthis.timeZoom = d3.zoom<SVGGElement, undefined>()\r\n\t\t\t.scaleExtent([1 / Math.max(1, timeRange[1]), 1.1])\r\n\t\t\t.translateExtent([[timeRange[0], 0], [timeRange[1], 0]])\r\n\t\t\t.on('zoom', this._zoomed.bind(this));\r\n\t\tthis.dataG.call(this.timeZoom);\r\n\t}\r\n\t_zoomed(ev: d3.D3ZoomEvent<SVGGElement, any>) {\r\n\t\t// https://stackoverflow.com/questions/69109270/updating-d3-zoom-behavior-from-v3\r\n\t\tvar range = this.xRange;\r\n\t\tvar t = ev.transform;\r\n\t\tvar totalRange = range[1] - range[0];\r\n\t\tif (!this.xAxisG)\r\n\t\t\treturn;\r\n\t\tconst domainElm = this.xAxisG.select('.domain');\r\n\t\tif (!domainElm)\r\n\t\t\treturn;\r\n\t\tconst domainElmNode = domainElm.node();\r\n\t\tif (!domainElmNode)\r\n\t\t\treturn;\r\n\t\tconst sizes = this.sizes;\r\n\t\tconst xAxisScale = d3.scaleLinear()\r\n\t\t\t.domain(this.xRange)\r\n\t\t\t.range([0, sizes.width]);\r\n\r\n\t\tlet zoomedScale = t.rescaleX(xAxisScale);\r\n\t\t//if (zoomedScale.domain()[0] < 0) {\r\n\t\t//\tzoomedScale.domain([0, Math.max(zoomedScale.domain()[1], 0)])\r\n\t\t//}\r\n\t\t\r\n\t\tconst xAxis = this.xAxis;\r\n\t\tif (!xAxis)\r\n\t\t\treturn;\r\n\t\txAxis.scale(zoomedScale);\r\n\r\n\t\tthis.sizes.row.range = zoomedScale.domain() as [number, number];\r\n\t\t// update tick formatter becase time range has changed\r\n\t\t// and we may want to use a different time unit\r\n\t\txAxis.tickFormat(\r\n\t\t\tcreateTimeFormatterForTimeRange(this.sizes.row.range)\r\n\t\t);\r\n\t\tthis.draw();\r\n\r\n\t}\r\n\t/*\r\n\t * extract width/height from svg and apply margin to main \"g\"\r\n\t */\r\n\tsetSizes() {\r\n\t\tvar svg = this.svg;\r\n\t\tvar s = this.sizes;\r\n\t\tconst _w = svg.style('width') || svg.attr('width');\r\n\t\tconst w = parseInt(_w);\r\n\t\tif (!Number.isFinite(w)) {\r\n\t\t\tthrow new Error('Can not resolve width of main SVG element');\r\n\t\t}\r\n\t\tvar h = parseInt(svg.style('height') || svg.attr('height'));\r\n\t\tif (!Number.isFinite(h)) {\r\n\t\t\tthrow new Error('Can not resolve height of main SVG element');\r\n\t\t}\r\n\t\ts.width = w - s.margin.left - s.margin.right;\r\n\t\tif (s.width <= 0) {\r\n\t\t\tthrow new Error('Width too small for main SVG element ' + s.width);\r\n\t\t}\r\n\t\ts.height = h - s.margin.top - s.margin.bottom;\r\n\t\tif (s.height <= 0) {\r\n\t\t\tthrow new Error('Height too small for main SVG element ' + s.height);\r\n\t\t}\r\n\t\tthis.dataG.attr('transform',\r\n\t\t\t'translate(' + s.margin.left + ',' + s.margin.top + ')');\r\n\r\n\t\tif (this.treelist) {\r\n\t\t\tthis.treelist.size(s.margin.left, s.height);\r\n\t\t}\r\n\t\tif (this.labelAreaSizeDragBar)\r\n\t\t\tthis.labelAreaSizeDragBar.size(s.dragWidth, s.height);\r\n\r\n\t}\r\n\r\n\tdrawYHelpLine() {\r\n\t\tconst height = this.sizes.height;\r\n\t\tconst vhl = this.verticalHelpLine;\r\n\t\tconst svg = this.svg;\r\n\t\tconst graph = this;\r\n\r\n\t\tfunction moveVerticalHelpLine(ev: any) {\r\n\t\t\tconst svgNode = svg.node();\r\n\t\t\tif (!svgNode) {\r\n\t\t\t\tthrow new Error(\"SVG Node should be constructed\");\r\n\t\t\t}\r\n\r\n\t\t\tvar boundingRect = svgNode.getBoundingClientRect();\r\n\t\t\tvar xPos = ev.clientX - boundingRect.left - graph.sizes.margin.left; //x position within the element.\r\n\t\t\tif (xPos < 0) { xPos = 0; }\r\n\t\t\tsvg.select('.vertical-help-line')\r\n\t\t\t\t.attr('transform', function () {\r\n\t\t\t\t\treturn 'translate(' + xPos + ',0)';\r\n\t\t\t\t})\r\n\t\t\t\t.attr('y2', graph.sizes.height);\r\n\t\t}\r\n\r\n\t\tif (vhl) {\r\n\t\t\tvhl.attr('y2', height);\r\n\t\t} else {\r\n\t\t\t// construct new help line\r\n\t\t\tthis.verticalHelpLine = this.dataG.append('line')\r\n\t\t\t\t.attr('class', 'vertical-help-line')\r\n\t\t\t\t.attr('x1', 0)\r\n\t\t\t\t.attr('y1', 0)\r\n\t\t\t\t.attr('x2', 0)\r\n\t\t\t\t.attr('y2', height);\r\n\r\n\t\t\tsvg.on('mousemove', moveVerticalHelpLine);\r\n\t\t}\r\n\t}\r\n\r\n\tdrawGridLines() {\r\n\t\t// simple graph with grid lines in d3v4\r\n\t\t// https://bl.ocks.org/d3noob/c506ac45617cf9ed39337f99f8511218\r\n\t\tconst height = this.sizes.height;\r\n\t\tconst xAxisScale = this.waveRowX;\r\n\t\tif (!xAxisScale)\r\n\t\t\treturn;\r\n\t\tconst xValues = xAxisScale.ticks(this.TICKS_PER_X_AXIS)\r\n\t\t\t.map(function (d: number) {\r\n\t\t\t\treturn xAxisScale(d);\r\n\t\t\t});\r\n\t\t// add the X gridlines (parallel with x axis)\r\n\t\tlet gridLines = this.dataG.selectAll<SVGLineElement, number>('.grid-line-x')\r\n\t\t\t.data(xValues);\r\n\t\tif (!gridLines)\r\n\t\t\tthrow new Error(\"Can not find grid-line-x\");\r\n\t\tgridLines\r\n\t\t\t.enter()\r\n\t\t\t.append('line')\r\n\t\t\t.attr('class', 'grid-line-x')\r\n\t\t\t.merge(gridLines)\r\n\t\t\t.attr('x1', function (d: number) { return d; })\r\n\t\t\t.attr('y1', 0)\r\n\t\t\t.attr('x2', function (d: number) { return d; })\r\n\t\t\t.attr('y2', height);\r\n\r\n\t\tgridLines.exit().remove();\r\n\t}\r\n\r\n\tdrawXAxis() {\r\n\t\tconst sizes = this.sizes;\r\n\t\tconst xAxisScale = this.waveRowX = d3.scaleLinear()\r\n\t\t\t.domain(sizes.row.range)\r\n\t\t\t.range([0, sizes.width]);\r\n\r\n\t\t// var axisX = g.selectAll(\".axis-x\")\r\n\t\t// https://bl.ocks.org/HarryStevens/54d01f118bc8d1f2c4ccd98235f33848\r\n\t\t// General Update Pattern, I https://bl.ocks.org/mbostock/3808218\r\n\t\t// http://bl.ocks.org/nnattawat/9054068\r\n\t\tvar xaxisG = this.xAxisG;\r\n\t\tif (xaxisG) {\r\n\t\t\t// update xaxisG\r\n\t\t\tvar xAxis = this.xAxis;\r\n\t\t\tif (!xAxis) {\r\n\t\t\t\tthrow new Error(\"xAxis should exists if xAxisG exists\");\r\n\t\t\t}\r\n\t\t\txaxisG.call(xAxis.scale(xAxisScale));\r\n\t\t} else {\r\n\t\t\t// create xaxisG\r\n\t\t\tthis.xAxis = d3.axisTop(xAxisScale)\r\n\t\t\t\t.tickFormat(\r\n\t\t\t\t\tcreateTimeFormatterForTimeRange(this.sizes.row.range)\r\n\t\t\t\t);\r\n\t\t\tthis.xAxisG = this.dataG.append('g')\r\n\t\t\t\t.attr('class', 'axis axis-x')\r\n\t\t\t\t.call(this.xAxis);\r\n\t\t}\r\n\t}\r\n\r\n\tdrawControlIcons() {\r\n\t\tconst _this = this;\r\n\t\tconst sizes = this.sizes;\r\n\t\tconst ROW_Y = sizes.row.height + sizes.row.ypadding;\r\n\t\t// Define the div for the tooltip\r\n\r\n\t\tconst icons = [\r\n\t\t\t{\r\n\t\t\t\t'icon': faQuestion,\r\n\t\t\t\t'tooltip': 'd3-wave help placeholder[TODO]',\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\t'icon': faDownload,\r\n\t\t\t\t'tooltip': 'Download current screen as SVG image',\r\n\t\t\t\t'onclick': function () {\r\n\t\t\t\t\tconst svgNode = _this.svg.node();\r\n\t\t\t\t\tif (!svgNode) {\r\n\t\t\t\t\t\tthrow new Error(\"svgNode should exist\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst svg = exportStyledSvgToBlob(svgNode);\r\n\t\t\t\t\tconst url = URL.createObjectURL(svg);\r\n\t\t\t\t\twindow.open(url);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\t'icon': faArrowsH,\r\n\t\t\t\t'tooltip': 'Reset time zoom to fit screen',\r\n\t\t\t\t'onclick': function () {\r\n\t\t\t\t\t_this.zoomReset();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\t'icon': faFilter,\r\n\t\t\t\t'tooltip': 'Filter signals to display',\r\n\t\t\t\t'onclick': function() {\r\n\t\t\t\t\t// Implement filtering\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t];\r\n\r\n\t\tconst tooltip = new Tooltip((d) => d.tooltip);\r\n\t\tif (!this.yAxisG)\r\n\t\t\tthrow new Error(\"The yAxisG should be constructed at this point\")\r\n\t\tthis.yAxisG.selectAll('text')\r\n\t\t\t.data(icons).enter()\r\n\t\t\t.append(\"g\")\r\n\t\t\t.attr(\"transform\", function (d, i) {\r\n\t\t\t\treturn 'translate(' + (i * ROW_Y) + ',' + (-ROW_Y * 1) + ') scale(' + (ROW_Y / d.icon.icon[1] * 0.5) + ')';\r\n\t\t\t})\r\n\t\t\t.call(tooltip.addToElm.bind(tooltip))\r\n\t\t\t.on('click', function (ev, d) {\r\n\t\t\t\tif (d.onclick) {\r\n\t\t\t\t\treturn d.onclick();\r\n\t\t\t\t}\r\n\t\t\t\treturn null;\r\n\t\t\t})\r\n\t\t\t.append('path')\r\n\t\t\t.classed('icons', true)\r\n\t\t\t.attr('d', function (d) {\r\n\t\t\t\treturn d.icon.icon[4];\r\n\t\t\t});\r\n\t}\r\n\tdrawYAxis() {\r\n\t\tvar sizes = this.sizes;\r\n\t\tvar ROW_Y = sizes.row.height + sizes.row.ypadding;\r\n\t\t// drawWaveLabels\r\n\t\tthis.waveRowY = d3.scaleLinear()\r\n\t\t\t.domain([0, 1])\r\n\t\t\t.range([sizes.row.height, 0]);\r\n\t\t// y axis\r\n\t\tif (!this.yAxisG) {\r\n\t\t\t// this.yaxisG.remove();\r\n\t\t\tthis.yAxisG = this.svg.append('g')\r\n\t\t\t\t.classed('axis axis-y', true);\r\n\t\t\tthis.yAxisG.attr('transform',\r\n\t\t\t\t'translate(0,' + (sizes.margin.top + ROW_Y / 2) + ')');\r\n\t\t\tthis.drawControlIcons();\r\n\r\n\t\t\tif (this.treelist)\r\n\t\t\t\tthis.yAxisG.call(this.treelist.draw.bind(this.treelist));\r\n\t\t}\r\n\t\tif (!this.labelAreaSizeDragBar) {\r\n\t\t\tvar graph = this;\r\n\t\t\tthis.labelAreaSizeDragBar = new DragBarVertical(\r\n\t\t\t\tthis.yAxisG,\r\n\t\t\t\t[sizes.dragWidth, sizes.height],\r\n\t\t\t\t[0, sizes.width + sizes.margin.left],\r\n\t\t\t\t[sizes.margin.left, sizes.margin.top]\r\n\t\t\t);\r\n\t\t\tthis.labelAreaSizeDragBar.onDrag(function (drag: DragBarVertical) {\r\n\t\t\t\tsizes.margin.left = drag.x;\r\n\t\t\t\tgraph.setSizes();\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\t// draw whole graph\r\n\tdraw() {\r\n\t\tthis.drawXAxis();\r\n\t\tthis.drawGridLines();\r\n\t\tthis.drawYHelpLine();\r\n\t\tthis.drawYAxis();\r\n\r\n\t\tvar sizes = this.sizes;\r\n\t\tvar graph = this;\r\n\t\t// drawWaves\r\n\t\t// remove previously rendered row data\r\n\t\tthis.dataG.selectAll('.value-row')\r\n\t\t\t.remove();\r\n\r\n\t\tvar valueRows = this.dataG.selectAll<SVGGElement, WaveGraphSignal>('.value-row')\r\n\t\t\t.data(graph.data);\r\n\r\n\t\tfunction renderWaveRows(selection: d3.Selection<SVGGElement, WaveGraphSignal, any, any>) {\r\n\t\t\t// Select correct renderer function based on type of data series\r\n\t\t\tselection.each(function (this: SVGGElement, d) {\r\n\t\t\t\t// var name = d[0];\r\n\t\t\t\tconst signalType = d.type;\r\n\t\t\t\tlet data = d.data;\r\n\t\t\t\tif (data && data.length) {\r\n\t\t\t\t\tconst parent = d3.select(this);\r\n\t\t\t\t\tconst range = graph.sizes.row.range;\r\n\t\t\t\t\tdata = filterDataByTime(data, [Math.max(range[0], 0), Math.max(range[1], 1)]);\r\n\t\t\t\t\tif (!signalType.renderer) {\r\n\t\t\t\t\t\tthrow new Error(\"Signal must have renderer already assinged\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsignalType.renderer.render(parent, data, signalType, signalType.formatter);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\t// move value row to it's possition\r\n\t\tvar ROW_Y = sizes.row.height + sizes.row.ypadding;\r\n\t\tvalueRows.enter()\r\n\t\t\t.append('g')\r\n\t\t\t.attr('class', 'value-row')\r\n\t\t\t.merge(valueRows)\r\n\t\t\t.call(renderWaveRows)\r\n\t\t\t.attr('transform', (d, i) => 'translate(0,' + (i * ROW_Y) + ')');\r\n\t}\r\n\r\n\tbindData(_signalData: WaveGraphSignal) {\r\n\t\tif (_signalData.constructor !== Object) {\r\n\t\t\tthrow new Error('Data in invalid format (should be dictionary and is ' + _signalData + ')');\r\n\t\t}\r\n\t\tthis._allData = _signalData;\r\n\t\tvar maxT = 0;\r\n\t\tconst rowRenderers = this.rowRenderers;\r\n\t\tfunction findRendererAndDiscoverMaxT(d: WaveGraphSignal) {\r\n\t\t\tconst dData = d.data;\r\n\t\t\tif (dData && dData.length) {\r\n\t\t\t\tconst lastTimeInData = dData[dData.length - 1][0];\r\n\t\t\t\tmaxT = Math.max(maxT, lastTimeInData);\r\n\t\t\t}\r\n\t\t\tconst signalType = d.type;\r\n\t\t\tfor (const renderer of rowRenderers) {\r\n\t\t\t\tif (renderer.select(signalType)) {\r\n\t\t\t\t\tvar formatter = signalType.formatter;\r\n\t\t\t\t\tif (!formatter) {\r\n\t\t\t\t\t\tformatter = renderer.DEFAULT_FORMAT;\r\n\t\t\t\t\t} else if (typeof formatter === 'string') {\r\n\t\t\t\t\t\tformatter = renderer.FORMATTERS[formatter];\r\n\t\t\t\t\t\tif (!formatter) {\r\n\t\t\t\t\t\t\tthrow new Error(\"Formatter value invalid \" + signalType.formatter + \"(\" + d.name + \")\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsignalType.formatter = formatter;\r\n\t\t\t\t\tsignalType.renderer = renderer;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!signalType.renderer) {\r\n\t\t\t\tthrow new Error('None of installed renderers supports signalType:' + signalType);\r\n\t\t\t}\r\n\r\n\t\t\t(d.children || d._children || []).forEach(findRendererAndDiscoverMaxT);\r\n\t\t}\r\n\t\tfindRendererAndDiscoverMaxT(this._allData);\r\n\r\n\t\tvar sizes = this.sizes;\r\n\t\tthis.xRange[1] = sizes.row.range[1] = maxT;\r\n\t\tthis._setZoom();\r\n\t\tvar ROW_Y = sizes.row.height + sizes.row.ypadding;\r\n\t\tvar graph = this;\r\n\t\tif (!this.treelist) {\r\n\t\t\tthis.treelist = new TreeList(ROW_Y, this.labelContextMenu);\r\n\t\t\tthis.treelist\r\n\t\t\t\t.onChange(function (selection: d3.HierarchyNode<WaveGraphSignal>[]) {\r\n\t\t\t\t\tgraph.data = selection.map((d) => { return d.data; });\r\n\t\t\t\t\tgraph.draw();\r\n\t\t\t\t});\r\n\t\t}\r\n\t\tthis.setSizes();\r\n\t\tif (!this.treelist)\r\n\t\t\tthrow new Error(\"treelist should be already allocated\");\r\n\t\tthis.treelist.data(this._allData);\r\n\t}\r\n\tzoomReset() {\r\n\t\tif (!this.timeZoom)\r\n\t\t\tthrow new Error(\"timeZoom was not initialized\");\r\n\t\tthis.dataG.call(this.timeZoom.transform, d3.zoomIdentity)\r\n\t}\r\n\t//zoomToTimeRange(start: number, end: number) {\r\n\t//\tif (!this.timeZoom)\r\n\t//\t\tthrow new Error(\"timeZoom was not initialized\");\r\n\t//\td3.zoomTransform\r\n\t//\tthis.dataG.call(this.timeZoom.scaleBy, d3.zoomIdentity)\r\n\t//}\r\n}\r\n","import { SCALAR_FORMAT } from './rowRenderers/numFormat';\r\nimport type { NumbericDataValue, NumbericDataVectorValue, SignalDataValueTuple, WaveGraphSignal } from './data';\r\nimport { binarySearch } from './binarySearch';\r\n\r\n/**\r\n * Returns an array with strings of the given size.\r\n *\r\n * @param str  string to split\r\n * @param chunkSize Size of every group\r\n */\r\nfunction chunkString(str: string, chunkSize: number) {\r\n\treturn Array(Math.ceil(str.length / chunkSize)).fill(undefined).map(function (_, i) {\r\n\t\treturn str.slice(i * chunkSize, i * chunkSize + chunkSize);\r\n\t});\r\n}\r\n\r\nexport const PREVIEW_TYPE = {\r\n\tHEX_BYTES: function (d: NumbericDataVectorValue, size: number) {\r\n\t\tvar res = SCALAR_FORMAT.UINT_HEX(d[1]);\r\n\t\tvar extend = '0';\r\n\t\tif (res[0] == 'X') {\r\n\t\t\textend = 'X';\r\n\t\t}\r\n\t\tres = res.padStart(2 * size, extend);\r\n\t\treturn chunkString(res, 2);\r\n\t},\r\n\tASCII: \"ASCII\",\r\n\t...SCALAR_FORMAT,\r\n};\r\n\r\nfunction isPrintable(asciiCode: number) {\r\n\treturn asciiCode >= 0x20 && asciiCode < 0x7f;\r\n}\r\nfunction asAscii(i: number) {\r\n\treturn isPrintable(i) ? String.fromCharCode(i) : \".\";\r\n}\r\n\r\nexport class HexEdit {\r\n\taddrRange: [number, number];\r\n\taddrStep: number;\r\n\taddrPos: number;\r\n\tdataWordCellCnt: number;\r\n\tdataAreas: d3.Selection<HTMLTableCellElement, any, any, any>[];\r\n\tcurrentTime: number;\r\n\tparent: d3.Selection<any, any, any, any>;\r\n\tmainTable: d3.Selection<HTMLTableElement, any, any, any> | null;\r\n\t_data: WaveGraphSignal | null;\r\n\tcurrentData: NumbericDataValue[];\r\n\r\n\tconstructor(parent: d3.Selection<any, any, any, any>) {\r\n\t\t// view config\r\n\t\tthis.addrRange = [0, 8 * 4];\r\n\t\tthis.addrStep = 4;\r\n\t\tthis.addrPos = 0;\r\n\t\tthis.dataWordCellCnt = 4;\r\n\t\t// data\r\n\t\tthis._data = null;\r\n\t\tthis.currentData = [];\r\n\t\tthis.currentTime = 0;\r\n\t\t// html elements\r\n\t\tthis.parent = parent;\r\n\t\tthis.mainTable = null;\r\n\t\tthis.dataAreas = []; // list of td elements in the rows which are displaying the data\r\n\t}\r\n\t/**\r\n\t* Get or set data to this viewer\r\n\t*/\r\n\tdata(data: WaveGraphSignal) {\r\n\t\tif (arguments.length) {\r\n\t\t\tvar w = data.type.width as number[];\r\n\t\t\tif (!w || w.length != 2)\r\n\t\t\t\tthrow new Error(\"NotImplementedv (only 1 level of index and width of element)\");\r\n\t\t\tthis.dataWordCellCnt = this.addrStep = Math.ceil(w[w.length - 1] / 8);\r\n\t\t\tthis.addrRange = [0, w[0] * this.addrStep];\r\n\t\t\tthis._data = data;\r\n\t\t} else {\r\n\t\t\treturn this._data;\r\n\t\t}\r\n\t}\r\n\t// update select of data based on time\r\n\tsetTime(newTime: number) {\r\n\t\tif (this.currentTime === newTime) { return; }\r\n\t\t// build currentData from update informations from data\r\n\t\tlet cd = this.currentData;\r\n\t\tconst t = this.currentTime;\r\n\t\tif (!this._data)\r\n\t\t\treturn;\r\n\t\tconst data = this._data.data;\r\n\t\tlet startI = 0;\r\n\t\tif (newTime > t) {\r\n\t\t\t// update current data\r\n\t\t\tstartI = binarySearch(data, [t, \"\", 0],\r\n\t\t\t\t(el0, el1) => { return (el0[0] > el1[0]) as any as number; },\r\n\t\t\t\tfunction (ar, el) {\r\n\t\t\t\t\tif (el < ar[0]) { return 0; }\r\n\t\t\t\t\tif (el > ar[ar.length - 1]) { return ar.length; }\r\n\t\t\t\t\treturn -1;\r\n\t\t\t\t});\r\n\t\t} else {\r\n\t\t\t// create completly new data\r\n\t\t\tcd = this.currentData = [];\r\n\t\t}\r\n\t\tfor (var i = startI; i < data.length && data[i][0] <= newTime; i++) {\r\n\t\t\tconst d = data[i][1] as NumbericDataVectorValue; // [0] is time, \r\n\t\t\tconst addr = d[0];\r\n\t\t\tconst val = d[1];\r\n\t\t\tif (typeof addr === 'number')\r\n\t\t\t\tcd[addr] = val;\r\n\t\t\telse {\r\n\t\t\t\tif (addr.length != 1)\r\n\t\t\t\t\tthrow new Error(\"NotImplemented - array with multiple dimensions\");\r\n\t\t\t\tcd[addr[0] as number] = val;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tdraw() {\r\n\t\tif (!this.mainTable) {\r\n\t\t\tconst t = this.mainTable = this.parent.append(\"table\")\r\n\t\t\t\t.classed(\"d3-wave-hexedit\", true);\r\n\r\n\t\t\tvar inWordAddrTitles = [];\r\n\t\t\tfor (var i = 0; i < this.dataWordCellCnt + 1; i++) {\r\n\t\t\t\t// the first one is padding for address column\r\n\t\t\t\tvar title;\r\n\t\t\t\tif (i == 0) {\r\n\t\t\t\t\ttitle = \"\";\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttitle = (i - 1).toString(16).padStart(2, \"0\");\r\n\t\t\t\t}\r\n\t\t\t\tinWordAddrTitles.push(title);\r\n\t\t\t}\r\n\t\t\tt.append(\"tr\")\r\n\t\t\t\t.selectAll('td')\r\n\t\t\t\t.data(inWordAddrTitles).enter()\r\n\t\t\t\t.append('td')\r\n\t\t\t\t.classed(\"word-addr\", true)\r\n\t\t\t\t.text(function (d) {\r\n\t\t\t\t\treturn d;\r\n\t\t\t\t})\r\n\r\n\t\t\tthis.dataAreas = [];\r\n\t\t\tvar first = true;\r\n\t\t\tfor (var a = this.addrRange[0]; a < this.addrRange[1]; a += this.addrStep) {\r\n\t\t\t\t// construct the rows of the table\r\n\t\t\t\tvar tr = t.append(\"tr\");\r\n\t\t\t\t// print first column with address\r\n\t\t\t\ttr.append(\"td\")\r\n\t\t\t\t\t.classed(\"addr\", true)\r\n\t\t\t\t\t.text(\"0x\" + a.toString(16).padStart(2, \"0\"))\r\n\t\t\t\tif (first) {\r\n\t\t\t\t\t// first row contains the dell with data which spans over whole table\r\n\t\t\t\t\t// the data is in another table because we want to exclude the address\r\n\t\t\t\t\t// column from text selection in data area\r\n\t\t\t\t\tfirst = false;\r\n\t\t\t\t\tconst da = tr.append(\"td\")\r\n\t\t\t\t\tda.classed(\"data\", true)\r\n\t\t\t\t\t\t.attr(\"colspan\", this.dataWordCellCnt)\r\n\t\t\t\t\t\t.attr(\"rowspan\", (this.addrRange[1] - this.addrRange[0]) / this.addrStep)\r\n\t\t\t\t\tthis.dataAreas.push(da);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tconst dtable = this.dataAreas[this.dataAreas.length - 1].append(\"table\");\r\n\t\t\tconst da = this.dataAreas[0];\r\n\t\t\tconst maxI = this.addrRange[1] / this.addrStep;\r\n\t\t\tfor (var i = this.addrRange[0] / this.addrStep; i < maxI; i++) {\r\n\t\t\t\tlet d = this.currentData[i];\r\n\t\t\t\tif (d === undefined) {\r\n\t\t\t\t\td = \"X\";\r\n\t\t\t\t}\r\n\t\t\t\tvar byteStrings = PREVIEW_TYPE.HEX_BYTES(d as NumbericDataVectorValue, this.dataWordCellCnt).reverse();\r\n\t\t\t\tdtable.append(\"tr\")\r\n\t\t\t\t\t.selectAll(\"td\")\r\n\t\t\t\t\t.data(byteStrings)\r\n\t\t\t\t\t.enter()\r\n\t\t\t\t\t.append(\"td\")\r\n\t\t\t\t\t.classed(\"invalid\", (d) => d.indexOf(\"X\") >= 0)\r\n\t\t\t\t\t.text((d) => d);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n"],"names":["d3","faChevronRight","faChevronDown","faQuestion","faDownload","faArrowsH","faFilter"],"mappings":"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","x_google_ignoreList":[16]}